!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).OsmdAudioPlayer=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))}class t{constructor(){this.steps=[]}[Symbol.iterator](){return this.steps.values()}createStep(e){let t=this.steps.find((t=>t.tick===e));return t||(t={tick:e,notes:[]},this.steps.push(t)),t}addNote(e,t){var n;(null!==(n=this.steps.find((t=>t.tick===e)))&&void 0!==n?n:this.createStep(e)).notes.push(t)}delete(e){const t=this.steps.findIndex((t=>t.tick===e.tick));null!=t&&this.steps.splice(t,1)}sort(){return this.steps.sort(((e,t)=>e.tick-t.tick)),this}getFirstEmptyTick(){return this.sort().steps.filter((e=>!e.notes.length))[0].tick}}class n{constructor(e,n,o){this.stepQueue=new t,this.stepQueueIndex=0,this.scheduledTicks=new Set,this.currentTick=0,this.currentTickTimestamp=0,this.audioContextStartTime=0,this.schedulerIntervalHandle=null,this.scheduleInterval=200,this.schedulePeriod=500,this.tickDenominator=1024,this.lastTickOffset=300,this.playing=!1,this.noteSchedulingCallback=o,this.wholeNoteLength=e,this.audioContext=n}get schedulePeriodTicks(){return this.schedulePeriod/this.tickDuration}get audioContextTime(){return this.audioContext?1e3*(this.audioContext.currentTime-this.audioContextStartTime):0}get tickDuration(){return this.wholeNoteLength/this.tickDenominator}get calculatedTick(){return this.currentTick+Math.round((this.audioContextTime-this.currentTickTimestamp)/this.tickDuration)}start(){this.playing=!0,this.stepQueue.sort(),this.audioContextStartTime=this.audioContext.currentTime,this.currentTickTimestamp=this.audioContextTime,this.schedulerIntervalHandle||(this.schedulerIntervalHandle=window.setInterval((()=>this.scheduleIterationStep()),this.scheduleInterval))}setIterationStep(e){e=Math.min(this.stepQueue.steps.length-1,e),this.stepQueueIndex=e,this.currentTick=this.stepQueue.steps[this.stepQueueIndex].tick}pause(){this.playing=!1}resume(){this.playing=!0,this.currentTickTimestamp=this.audioContextTime}reset(){this.playing=!1,this.currentTick=0,this.currentTickTimestamp=0,this.stepQueueIndex=0,clearInterval(this.scheduleInterval),this.schedulerIntervalHandle=null,console.log("||||||||||||||||||||||||||||")}loadNotes(e){let t=this.lastTickOffset;this.stepQueue.steps.length>0&&(t=this.stepQueue.getFirstEmptyTick());for(let n of e)if(!n.IsGrace){for(let e of n.Notes)this.stepQueue.addNote(t,e),this.stepQueue.createStep(t+e.Length.RealValue*this.tickDenominator);this.noteSchedulingCallback(0,[],!0)}}scheduleIterationStep(){var e,t;if(!this.playing)return;this.currentTick=this.calculatedTick,this.currentTickTimestamp=this.audioContextTime;let n=null===(e=this.stepQueue.steps[this.stepQueueIndex])||void 0===e?void 0:e.tick;for(;this.nextTickAvailableAndWithinSchedulePeriod(n);){let e=this.stepQueue.steps[this.stepQueueIndex],o=(e.tick-this.currentTick)*this.tickDuration;o<0&&(o=0),this.scheduledTicks.add(e.tick),this.noteSchedulingCallback(o/1e3,e.notes,!1),this.stepQueueIndex++,n=null===(t=this.stepQueue.steps[this.stepQueueIndex])||void 0===t?void 0:t.tick}for(let e of this.scheduledTicks)e<=this.currentTick&&this.scheduledTicks.delete(e)}nextTickAvailableAndWithinSchedulePeriod(e){return e&&this.currentTickTimestamp+(e-this.currentTick)*this.tickDuration<=this.currentTickTimestamp+this.schedulePeriod}}var o;!function(e){e[e.None=0]="None",e[e.Staccato=1]="Staccato",e[e.Legato=2]="Legato"}(o||(o={}));const r=[];var a=[];"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function i(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return s(null==t&&n.path)}},n.exports),n.exports}function s(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var c={decode:function(e,t){for(var n,o,r,a=e.replace(/[^A-Za-z0-9\+\/]/g,""),i=a.length,s=t?Math.ceil((3*i+1>>2)/t)*t:3*i+1>>2,c=new Uint8Array(s),u=0,l=0,h=0;h<i;h++)if(o=3&h,u|=((r=a.charCodeAt(h))>64&&r<91?r-65:r>96&&r<123?r-71:r>47&&r<58?r+4:43===r?62:47===r?63:0)<<18-6*o,3===o||i-h==1){for(n=0;n<3&&l<s;n++,l++)c[l]=u>>>(16>>>n&24)&255;u=0}return c}},u=function(e,t){return new Promise((function(n,o){var r=new XMLHttpRequest;t&&(r.responseType=t),r.open("GET",e),r.onload=function(){200===r.status?n(r.response):o(Error(r.statusText))},r.onerror=function(){o(Error("Network Error"))},r.send()}))},l=i((function(e){function t(e){return function(t){return"string"==typeof t&&e.test(t)}}function n(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function o(e,t,n,o){var c=t instanceof ArrayBuffer?r:a(t)?i:function(e){return e&&"function"==typeof e.then}(t)?s:l(t)?h:function(e){return e&&"object"==typeof e}(t)?d:f(t)?p:m(t)?v:g(t)?y:null;return c?c(e,t,n||{}):o?Promise.resolve(o):Promise.reject("Source not valid ("+t+")")}function r(e,t,n){return new Promise((function(n,o){e.decodeAudioData(t,(function(e){n(e)}),(function(){o("Can't decode audio data ("+t.slice(0,30)+"...)")}))}))}o.fetch=u;var a=t(/\.(mp3|wav|ogg)(\?.*)?$/i);function i(e,t,r){var a=n(r.from,t);return o(e,o.fetch(a,"arraybuffer"),r)}function s(e,t,n){return t.then((function(t){return o(e,t,n)}))}var l=Array.isArray;function h(e,t,n){return Promise.all(t.map((function(t){return o(e,t,n,t)})))}function d(e,t,n){var r={},a=Object.keys(t).map((function(a){if(n.only&&-1===n.only.indexOf(a))return null;var i=t[a];return o(e,i,n,i).then((function(e){r[a]=e}))}));return Promise.all(a).then((function(){return r}))}var f=t(/\.json(\?.*)?$/i);function p(e,t,r){var a=n(r.from,t);return o(e,o.fetch(a,"text").then(JSON.parse),r)}var m=t(/^data:audio/);function v(e,t,n){var r=t.indexOf(",");return o(e,c.decode(t.slice(r+1)).buffer,n)}var g=t(/\.js(\?.*)?$/i);function y(e,t,r){var a=n(r.from,t);return o(e,o.fetch(a,"text").then(w),r)}function w(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=o),"undefined"!=typeof window&&(window.loadAudio=o)})),h=function(e){var t=e.createGain(),n=t._voltage=function(e){var t=e.createBufferSource(),n=e.createBuffer(1,2,e.sampleRate);return n.getChannelData(0).set(f),t.buffer=n,t.loop=!0,t}(e),o=p(n),r=p(n),a=p(n);return t._startAmount=p(r),t._endAmount=p(a),t._multiplier=p(o),t._multiplier.connect(t),t._startAmount.connect(t),t._endAmount.connect(t),t.value=o.gain,t.startValue=r.gain,t.endValue=a.gain,t.startValue.value=0,t.endValue.value=0,Object.defineProperties(t,d),t};var d={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,o=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var r=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),o.cancelScheduledValues(e),o.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(r,this._decayFrom,m(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var o=this._multiplier.gain,r=this._startAmount.gain,a=this._endAmount.gain;o.cancelScheduledValues(e),r.cancelScheduledValues(e),a.cancelScheduledValues(e);var i=m(this.release);if(this.attack&&e<this._decayFrom){var s=function(e,t,n,o,r){var a=e+(r-n)/(o-n)*(t-e);a<=e&&(a=e);a>=t&&(a=t);return a}(0,1,this._startedAt,this._decayFrom,e);o.linearRampToValueAtTime(s,e),r.linearRampToValueAtTime(1-s,e),r.setTargetAtTime(0,e,i)}a.setTargetAtTime(1,e,i),o.setTargetAtTime(0,e,i)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},f=new Float32Array([1,1]);function p(e){var t=e.context.createGain();return e.connect(t),t}function m(e){return Math.log(e+1)/Math.log(100)}var v={},g={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function y(e){return"number"==typeof e}var w=["attack","decay","sustain","release"];var C=function(e,t,n){var o=!1,r=0,a={},i=e.createGain();i.gain.value=1;var s=Object.assign({},g,n),c={context:e,out:i,opts:s};return t instanceof AudioBuffer?c.buffer=t:c.buffers=t,c.start=function(t,n,i){if(c.buffer&&null!==t)return c.start(null,t,n);var s=t?c.buffers[t]:c.buffer;if(s){if(o){var l=i||v;n=Math.max(e.currentTime,n||0),c.emit("start",n,t,l);var h=u(t,s,l);return h.id=function(t,n){return n.id=r++,a[n.id]=n,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),c.emit("ended",t,n.id,n)},n.id}(0,h),h.env.start(n),h.source.start(n),c.emit("started",n,h.id,h),l.duration&&h.stop(n+l.duration),h}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},c.play=function(e,t,n){return c.start(e,t,n)},c.stop=function(e,t){var n;return(t=t||Object.keys(a)).map((function(t){return(n=a[t])?(n.stop(e),n.id):null}))},c.connect=function(e){return o=!0,i.connect(e),c},c.emit=function(e,t,n,o){c.onevent&&c.onevent(e,t,n,o);var r=c["on"+e];r&&r(t,n,o)},c;function u(t,n,o){var r,a=e.createGain();return a.gain.value=0,a.connect(i),a.env=function(e,t,n){var o=h(e),r=t.adsr||n.adsr;return w.forEach((function(e,a){o[e]=r?r[a]:t[e]||n[e]})),o.value.value=y(t.gain)?t.gain:y(n.gain)?n.gain:1,o}(e,o,s),a.env.connect(a.gain),a.source=e.createBufferSource(),a.source.buffer=n,a.source.connect(a),a.source.loop=o.loop||s.loop,a.source.playbackRate.value=(r=o.cents||s.cents)?Math.pow(2,r/1200):1,a.source.loopStart=o.loopStart||s.loopStart,a.source.loopEnd=o.loopEnd||s.loopEnd,a.stop=function(n){var o=n||e.currentTime;c.emit("stop",o,t);var r=a.env.stop(o);a.source.stop(r)},a}};function _(e,t){return function(n,o,r,a){e(n,o,r,a),t(n,o,r,a)}}var b=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;var T=[0,2,4,5,7,9,11];function I(e,t,n){if("string"!=typeof e)return null;var o=b.exec(e);if(!o||!t&&o[4])return null;var r={letter:o[1].toUpperCase(),acc:o[2].replace(/x/g,"##")};return r.pc=r.letter+r.acc,r.step=(r.letter.charCodeAt(0)+3)%7,r.alt="b"===r.acc[0]?-r.acc.length:r.acc.length,r.chroma=T[r.step]+r.alt,o[3]&&(r.oct=+o[3],r.midi=r.chroma+12*(r.oct+1),r.freq=M(r.midi,n)),t&&(r.tonicOf=o[4]),r}function M(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var x={parse:I,regex:function(){return b},midiToFreq:M};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(e){x[e]=function(t){var n=I(t);return n&&void 0!==n[e]?n[e]:null}}));var A=x,S=function(e){return function(e){return null!==e&&e!==[]&&e>=0&&e<129}(e)?+e:A.midi(e)},N=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:S,o=function(e){return e?n(e)||e:null};e.buffers=function(e,t){return Object.keys(e).reduce((function(n,o){return n[t(o)]=e[o],n}),{})}(e.buffers,o);var r=e.start;e.start=function(e,t,n){var a=o(e),i=a%1;return i&&(a=Math.floor(a),n=Object.assign(n||{},{cents:Math.floor(100*i)})),r(a,t,n)}}return e};var O=Array.isArray,k={},E=i((function(e,t){e.exports=function e(t,n,o){function r(i,c){if(!n[i]){if(!t[i]){if(!c&&s)return s();if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[i]={exports:{}};t[i][0].call(l.exports,(function(e){var n=t[i][1][e];return r(n||e)}),l,l.exports,e,t,n,o)}return n[i].exports}for(var a=s,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){function t(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}return new t(e)},t.exports=n.default},{}]},{},[1])(1)})),D=i((function(e){function t(e,t,n){return function(e){return e.listenToMidi=function(t,n){var o={},r=n||{},a=r.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:E(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!r.channel||n.channel===r.channel)switch(n.messageType){case"noteon":o[n.key]=e.play(n.key,0,{gain:a(n.velocity)});break;case"noteoff":o[n.key]&&(o[n.key].stop(),delete o[n.key])}},e},e}(function(e){return e.schedule=function(t,n){var o,r,a,i,s=e.context.currentTime,c=t<s?s:t;return e.emit("schedule",c,n),n.map((function(t){return t?(O(t)?(o=t[0],r=t[1]):(o=t.time,r=t),function(e){return e&&"object"==typeof e}(r)?(a=r.name||r.key||r.note||r.midi||null,i=r):(a=r,i=k),e.start(a,c+(o||0),i)):null}))},e}(N(function(e){return e.on=function(t,n){if(1===arguments.length&&"function"==typeof t)return e.on("event",t);var o="on"+t,r=e[o];return e[o]=r?_(r,n):n,e},e}(C(e,t,n)))))}e.exports&&(e.exports=t),"undefined"!=typeof window&&(window.SamplePlayer=t)})),P=i((function(e,t){!function(e){function t(e,t){return Array(t+1).join(e)}function n(e){return"number"==typeof e}function o(e){return"string"==typeof e}function r(e){return void 0!==e}function a(e,t){return Math.pow(2,(e-69)/12)*(t||440)}function i(){return C}function s(e,t,n){if("string"!=typeof e)return null;var o=C.exec(e);if(!o||!t&&o[4])return null;var r={letter:o[1].toUpperCase(),acc:o[2].replace(/x/g,"##")};r.pc=r.letter+r.acc,r.step=(r.letter.charCodeAt(0)+3)%7,r.alt="b"===r.acc[0]?-r.acc.length:r.acc.length;var i=_[r.step]+r.alt;return r.chroma=i<0?12+i:i%12,o[3]&&(r.oct=+o[3],r.midi=i+12*(r.oct+1),r.freq=a(r.midi,n)),t&&(r.tonicOf=o[4]),r}function c(e){return n(e)?e<0?t("b",-e):t("#",e):""}function u(e){return n(e)?""+e:""}function l(e,t,n){return null==e?null:e.step?l(e.step,e.alt,e.oct):e<0||e>6?null:b.charAt(e)+c(t)+u(n)}function h(e){if((n(e)||o(e))&&e>=0&&e<128)return+e;var t=s(e);return t&&r(t.midi)?t.midi:null}function d(e,t){var n=h(e);return null===n?null:a(n,t)}function f(e){return(s(e)||{}).letter}function p(e){return(s(e)||{}).acc}function m(e){return(s(e)||{}).pc}function v(e){return(s(e)||{}).step}function g(e){return(s(e)||{}).alt}function y(e){return(s(e)||{}).chroma}function w(e){return(s(e)||{}).oct}var C=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,_=[0,2,4,5,7,9,11],b="CDEFGAB";e.regex=i,e.parse=s,e.build=l,e.midi=h,e.freq=d,e.letter=f,e.acc=p,e.pc=m,e.step=v,e.alt=g,e.chroma=y,e.oct=w}(t)}));function R(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof R))return new R(e);this.nameToUrl=t||R.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function V(e,t){return t=t||{},function(n,o,r,a){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var i=n>0&&n<129?+n:P.midi(n),s=i?P.midiToFreq(i,440):null;if(s){r=r||.2;var c=(a=a||{}).destination||t.destination||e.destination,u=a.vcoType||t.vcoType||"sine",l=a.gain||t.gain||.4,h=e.createOscillator();h.type=u,h.frequency.value=s;var d=e.createGain();return d.gain.value=l,h.connect(d),d.connect(c),h.start(o),r>0&&h.stop(o+r),h}}}R.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},R.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var o={name:e,play:V(n,t)};if(this.instruments[e]=o,"default"!==e){var r=R.instrument(n,e,t).then((function(e){return o.play=e.play,o}));this.promises.push(r),o.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),r.then(e)}}else o.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return o},R.loadBuffers=function(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),R.instrument(e,t,n).then((function(e){return e.buffers}))},R.noteToMidi=P.midi;var F=R,B=i((function(e){function t(e){return/\.js(\?.*)?$/i.test(e)}function n(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}F.instrument=function e(o,r,a){if(1===arguments.length)return function(t,n){return e(o,t,n)};var i=a||{},s=i.isSoundfontURL||t,c=i.nameToUrl||n,u=s(r)?r:c(r,i.soundfont,i.format);return l(o,u,{only:i.only||i.notes}).then((function(e){var t=D(o,e,i).connect(i.destination?i.destination:o.destination);return t.url=u,t.name=r,t}))},F.nameToUrl=n,e.exports&&(e.exports=F),"undefined"!=typeof window&&(window.Soundfont=F)}));class L{constructor(){this.players=new Map,this.instruments=r.filter((e=>a.includes(this.getSoundfontInstrumentName(e[1])))).map((e=>({midiId:e[0],name:e[1],loaded:!1})))}init(e){this.audioContext=e}load(t){return e(this,void 0,void 0,(function*(){const e=this.instruments.find((e=>e.midiId===t));if(!e)return void console.warn("SoundfontPlayer does not support midi instrument ID "+t);if(this.players.has(t))return;let n="";e&&(n=this.getSoundfontInstrumentName(e.name));const o=yield B.instrument(this.audioContext,n);this.players.set(t,o)}))}stop(e){this.players.has(e)&&this.players.get(e).stop()}schedule(e,t,n){this.verifyPlayerLoaded(e),this.applyDynamics(n),this.players.has(e)&&this.players.get(e).schedule(t,n)}applyDynamics(e){for(const t of e)t.articulation===o.Staccato&&(t.gain=Math.max(t.gain+.3,1.3*t.gain),t.duration=Math.min(.4*t.duration,.4))}verifyPlayerLoaded(e){this.players.has(e)||console.warn("No soundfont player loaded for midi instrument "+e)}getSoundfontInstrumentName(e){return e.toLowerCase().replace(/\s+/g,"_")}}function W(e){return e.ParentVoiceEntry.isStaccato()?o.Staccato:o.None}function j(e,t){let n=e.Length.RealValue*t;return e.NoteTie&&(Object.is(e.NoteTie.StartNote,e)&&e.NoteTie.Notes[1]?n+=e.NoteTie.Notes[1].Length.RealValue*t:n=0),n}function Y(e){return e.ParentVoiceEntry.ParentVoice.Volume}class q{constructor(){this.subscribers=new Map}on(e,t){this.subscribers.get(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}emit(e,...t){const n=this.subscribers.get(e)||[];for(const e of n)e(...t)}}const X=(e,t,n)=>({endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}),z=(e,t,n)=>({endTime:t,insertTime:n,type:"linearRampToValue",value:e}),G=(e,t)=>({startTime:t,type:"setValue",value:e}),Z=(e,t,n)=>({duration:n,startTime:t,type:"setValueCurve",values:e}),U=(e,t,{startTime:n,target:o,timeConstant:r})=>o+(t-o)*Math.exp((n-e)/r),Q=e=>"exponentialRampToValue"===e.type,H=e=>"linearRampToValue"===e.type,$=e=>Q(e)||H(e),J=e=>"setValue"===e.type,K=e=>"setValueCurve"===e.type,ee=(e,t,n,o)=>{const r=e[t];return void 0===r?o:$(r)||J(r)?r.value:K(r)?r.values[r.values.length-1]:U(n,ee(e,t-1,r.startTime,o),r)},te=(e,t,n,o,r)=>void 0===n?[o.insertTime,r]:$(n)?[n.endTime,n.value]:J(n)?[n.startTime,n.value]:K(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,ee(e,t-1,n.startTime,r)],ne=e=>"cancelAndHold"===e.type,oe=e=>"cancelScheduledValues"===e.type,re=e=>ne(e)||oe(e)?e.cancelTime:Q(e)||H(e)?e.endTime:e.startTime,ae=(e,t,n,{endTime:o,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((e-t)/(o-t)):0,ie=(e,t,n,{endTime:o,value:r})=>n+(e-t)/(o-t)*(r-n),se=(e,{duration:t,startTime:n,values:o})=>((e,t)=>{const n=Math.floor(t),o=Math.ceil(t);return n===o?e[n]:(1-(t-n))*e[n]+(1-(o-t))*e[o]})(o,(e-n)/t*(o.length-1)),ce=e=>"setTarget"===e.type;class ue{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=re(e);if(ne(e)||oe(e)){const n=this._automationEvents.findIndex((e=>re(e)>=t)),o=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),ne(e)){const e=this._automationEvents[this._automationEvents.length-1];if(void 0!==o&&$(o)){if(ce(e))throw new Error("The internal list is malformed.");const n=K(e)?e.startTime+e.duration:re(e),r=K(e)?e.values[e.values.length-1]:e.value,a=Q(o)?ae(t,n,r,o):ie(t,n,r,o),i=Q(o)?X(a,t,this._currenTime):z(a,t,this._currenTime);this._automationEvents.push(i)}void 0!==e&&ce(e)&&this._automationEvents.push(G(this.getValue(t),t)),void 0!==e&&K(e)&&e.startTime+e.duration>t&&(this._automationEvents[this._automationEvents.length-1]=Z(new Float32Array([6,7]),e.startTime,t-e.startTime))}}else{const n=this._automationEvents.findIndex((e=>re(e)>t)),o=-1===n?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(void 0!==o&&K(o)&&re(o)+o.duration>t)return!1;const r=Q(e)?X(e.value,e.endTime,this._currenTime):H(e)?z(e.value,t,this._currenTime):e;if(-1===n)this._automationEvents.push(r);else{if(K(e)&&t+e.duration>re(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,r)}}return!0}flush(e){const t=this._automationEvents.findIndex((t=>re(t)>e));if(t>1){const e=this._automationEvents.slice(t-1),n=e[0];ce(n)&&e.unshift(G(ee(this._automationEvents,t-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=e}}getValue(e){if(0===this._automationEvents.length)return this._defaultValue;const t=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((t=>re(t)>e)),o=this._automationEvents[n],r=re(t)<=e?t:this._automationEvents[n-1];if(void 0!==r&&ce(r)&&(void 0===o||!$(o)||o.insertTime>e))return U(e,ee(this._automationEvents,n-2,r.startTime,this._defaultValue),r);if(void 0!==r&&J(r)&&(void 0===o||!$(o)))return r.value;if(void 0!==r&&K(r)&&(void 0===o||!$(o)||r.startTime+r.duration>e))return e<r.startTime+r.duration?se(e,r):r.values[r.values.length-1];if(void 0!==r&&$(r)&&(void 0===o||!$(o)))return r.value;if(void 0!==o&&Q(o)){const[t,a]=te(this._automationEvents,n-1,r,o,this._defaultValue);return ae(e,t,a,o)}if(void 0!==o&&H(o)){const[t,a]=te(this._automationEvents,n-1,r,o,this._defaultValue);return ie(e,t,a,o)}return this._defaultValue}}const le=new WeakSet,he=new WeakMap,de=new WeakMap,fe=new WeakMap,pe=new WeakMap,me=new WeakMap,ve=new WeakMap,ge=new WeakMap,ye=new WeakMap,we=new WeakMap,Ce={construct:()=>Ce},_e=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,be=(e,t)=>{const n=[];let o=e.replace(/^[\s]+/,""),r=o.match(_e);for(;null!==r;){const e=r[1].slice(1,-1),a=r[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());n.push(a),o=o.slice(r[0].length).replace(/^[\s]+/,""),r=o.match(_e)}return[n.join(";"),o]},Te=e=>{if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Ie=e=>{if(!(e=>{try{new new Proxy(e,Ce)}catch{return!1}return!0})(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},Me={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},xe=(e,t)=>e.context===t,Ae=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Se=()=>{try{return new DOMException("","IndexSizeError")}catch(e){return e.code=1,e.name="IndexSizeError",e}},Ne=e=>{var t;e.getChannelData=(t=e.getChannelData,n=>{try{return t.call(e,n)}catch(e){if(12===e.code)throw Se();throw e}})},Oe={numberOfChannels:1},ke=-34028234663852886e22,Ee=-ke,De=(e,t)=>{const n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Pe=e=>De(ge,e),Re=e=>{if(le.has(e))throw new Error("The AudioNode is already stored.");le.add(e),Pe(e).forEach((e=>e(!0)))},Ve=e=>{if(!le.has(e))throw new Error("The AudioNode is not stored.");le.delete(e),Pe(e).forEach((e=>e(!1)))},Fe={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Be=e=>"context"in e,Le=e=>Be(e[0]),We=e=>"port"in e,je=e=>"inputs"in e,Ye=(e,t,n,o)=>{if(je(t)){const r=t.inputs[o];return e.connect(r,n,0),[r,n,0]}return e.connect(t,n,o),[t,n,o]},qe=(e,t)=>{if(!Pe(e).delete(t))throw new Error("Missing the expected event listener.")},Xe=(e,t,n,o)=>{je(t)?e.disconnect(t.inputs[o],n,0):e.disconnect(t,n,o)},ze=e=>De(he,e),Ge=e=>De(fe,e),Ze=e=>De(de,e),Ue=e=>De(pe,e),Qe=(e,t,n,o)=>{for(const t of e)if(n(t)){if(o)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},He=e=>le.has(e),$e=e=>ye.has(e),Je=e=>!le.has(e),Ke=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[o]=n;return e.delete(o),o},et=(e,t)=>{!We(e)&&t.every((e=>0===e.size))&&Ve(e)},tt=e=>new Promise((t=>{const n=e.createScriptProcessor(256,1,1),o=e.createGain(),r=e.createBuffer(1,2,44100),a=r.getChannelData(0);a[0]=1,a[1]=1;const i=e.createBufferSource();i.buffer=r,i.loop=!0,i.connect(n).connect(e.destination),i.connect(o),i.disconnect(o),n.onaudioprocess=o=>{const r=o.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(e=>1===e))?t(!0):t(!1),i.stop(),n.onaudioprocess=null,i.disconnect(n),n.disconnect(e.destination)},i.start()})),nt=(e,t)=>{const n=new Map;for(const t of e)for(const e of t){const t=n.get(e);n.set(e,void 0===t?1:t+1)}n.forEach(((e,n)=>t(n,e)))},ot=e=>"context"in e,rt=(e,t,[n,o,r],a)=>{Qe(e[o],[t,n,r],(e=>e[0]===t&&e[1]===n),a)},at=(e,t,[n,o],r)=>{Qe(e,[t,n,o],(e=>e[0]===t&&e[1]===n),r)},it=(e,t,[n,o,r],a)=>{const i=e.get(n);void 0===i?e.set(n,new Set([[o,t,r]])):Qe(i,[o,t,r],(e=>e[0]===o&&e[1]===t),a)},st=(e,[t,n,o],r)=>{const a=e.get(t);void 0===a?e.set(t,new Set([[n,o]])):Qe(a,[n,o],(e=>e[0]===n),r)},ct=(e,t,n,o)=>{const r=De(e,t),a=Ke(r,(e=>e[0]===n&&e[1]===o));return 0===r.size&&e.delete(t),a},ut=(e,t,n)=>{const o=De(e,t),r=Ke(o,(e=>e[0]===n));return 0===o.size&&e.delete(t),r},lt=(e,t,n,o)=>{const{activeInputs:r,passiveInputs:a}=ze(t),{outputs:i}=ze(e),s=Pe(e),c=i=>{const s=Ze(t),c=Ze(e);if(i){const i=ct(a,e,n,o);rt(r,e,i,!1),$e(e)||Ye(c,s,n,o),Je(t)&&Re(t)}else{const i=((e,t,n,o)=>Ke(e[o],(e=>e[0]===t&&e[1]===n)))(r,e,n,o);it(a,o,i,!1),$e(e)||Xe(c,s,n,o),He(t)&&et(t,r)}};return!!Qe(i,[t,n,o],(e=>e[0]===t&&e[1]===n&&e[2]===o),!0)&&(s.add(c),He(e)?rt(r,e,[n,o,c],!0):it(a,o,[e,n,c],!0),!0)},ht=(e,t,n)=>{const{activeInputs:o,passiveInputs:r}=Ge(t),{outputs:a}=ze(e),i=Pe(e),s=a=>{const i=Ze(e),s=Ue(t);if(a){const t=ut(r,e,n);at(o,e,t,!1),$e(e)||i.connect(s,n)}else{const t=((e,t,n)=>Ke(e,(e=>e[0]===t&&e[1]===n)))(o,e,n);st(r,t,!1),$e(e)||i.disconnect(s,n)}};return!!Qe(a,[t,n],(e=>e[0]===t&&e[1]===n),!0)&&(i.add(s),He(e)?at(o,e,[n,s],!0):st(r,[e,n,s],!0),!0)},dt=(e,t,n)=>{for(const o of e)if(o[0]===t&&o[1]===n)return e.delete(o),o;return null},ft=(e,t,n,o)=>{const[r,a]=((e,t,n,o)=>{const{activeInputs:r,passiveInputs:a}=ze(t),i=dt(r[o],e,n);if(null===i)return[ct(a,e,n,o)[2],!1];return[i[2],!0]})(e,t,n,o);if(null!==r&&(qe(e,r),a&&!$e(e)&&Xe(Ze(e),Ze(t),n,o)),He(t)){const{activeInputs:e}=ze(t);et(t,e)}},pt=(e,t,n)=>{const[o,r]=((e,t,n)=>{const{activeInputs:o,passiveInputs:r}=Ge(t),a=dt(o,e,n);if(null===a)return[ut(r,e,n)[1],!1];return[a[2],!0]})(e,t,n);null!==o&&(qe(e,o),r&&!$e(e)&&Ze(e).disconnect(Ue(t),n))},mt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},vt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},gt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},yt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},wt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ct={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},_t={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},bt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Tt=()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}},It=()=>{try{return new DOMException("","InvalidAccessError")}catch(e){return e.code=15,e.name="InvalidAccessError",e}},Mt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},xt=(e,t,n,o,r,a,i,s,c,u,l)=>{const h=u.length;let d=s;for(let s=0;s<h;s+=1){let h=n[0]*u[s];for(let t=1;t<r;t+=1){const o=d-t&c-1;h+=n[t]*a[o],h-=e[t]*i[o]}for(let e=r;e<o;e+=1)h+=n[e]*a[d-e&c-1];for(let n=r;n<t;n+=1)h-=e[n]*i[d-n&c-1];a[d]=u[s],i[d]=h,d=d+1&c-1,l[s]=h}return d},At={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},St=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Nt=(e,t,n)=>{const o=t[n];void 0!==o&&o!==e[n]&&(e[n]=o)},Ot=(e,t)=>{Nt(e,t,"channelCount"),Nt(e,t,"channelCountMode"),Nt(e,t,"channelInterpretation")},kt=e=>"function"==typeof e.getFloatTimeDomainData,Et=(e,t,n)=>{const o=t[n];void 0!==o&&o!==e[n].value&&(e[n].value=o)},Dt=e=>{var t;e.start=(t=e.start,(n=0,o=0,r)=>{if("number"==typeof r&&r<0||o<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,o,r)})},Pt=e=>{var t;e.stop=(t=e.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},Rt=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e);function Vt(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function Ft(e,t){let n=[0,0];for(let a=e.length-1;a>=0;a-=1)r=t,n=[(o=n)[0]*r[0]-o[1]*r[1],o[0]*r[1]+o[1]*r[0]],n[0]+=e[a];var o,r;return n}const Bt=()=>{try{return new DOMException("","NotSupportedError")}catch(e){return e.code=9,e.name="NotSupportedError",e}},Lt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,type:"sine"},Wt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},jt={disableNormalization:!1},Yt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},qt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Xt=e=>{if(null===e)return!1;const t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},zt=(e,t,n,o)=>{let r=Object.getPrototypeOf(e);for(;!r.hasOwnProperty(t);)r=Object.getPrototypeOf(r);const{get:a,set:i}=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(e,t,{get:n(a),set:o(i)})},Gt=(e,t)=>n=>{const o={value:e};return Object.defineProperties(n,{currentTarget:o,target:o}),"function"==typeof t?t.call(e,n):t.handleEvent.call(e,n)},Zt=(Ut=new Map,Qt=new WeakMap,(e,t)=>{const n=Qt.get(e);if(void 0!==n)return n;const o=Ut.get(e);if(void 0!==o)return o;try{const n=t();return n instanceof Promise?(Ut.set(e,n),n.catch((()=>!1)).then((t=>(Ut.delete(e),Qt.set(e,t),t)))):(Qt.set(e,n),n)}catch{return Qt.set(e,!1),!1}});var Ut,Qt;const Ht="undefined"==typeof window?null:window,$t=(e=>null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null)(Ht),Jt=(e=>t=>null!==e&&t instanceof e)($t),Kt=(e=>null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null)(Ht),en=((e,t,n)=>o=>{if("closed"===o.state&&null!==t&&"webkitAudioContext"!==t.name){if(!e(o)){const e=me.get(o);if(void 0!==e)return e;const n=new t;return me.set(o,n),n}{const e=me.get(o);if(void 0!==e)return e;if(null!==n){const e=new n(1,1,44100);return me.set(o,e),e}}}return null})(Jt,Kt,$t),tn=(e=>(t,n)=>{const o=e(t);return n(null!==o?o:t)})(en),nn=((e,t,n)=>(o,r)=>{const a=n(o,(e=>e.createAnalyser()));if(Ot(a,r),!(r.maxDecibels>r.minDecibels))throw t();return Nt(a,r,"fftSize"),Nt(a,r,"maxDecibels"),Nt(a,r,"minDecibels"),Nt(a,r,"smoothingTimeConstant"),e(kt,(()=>kt(a)))||(e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const o=Math.max(n.length,e.fftSize);for(let e=0;e<o;e+=1)t[e]=.0078125*(n[e]-128);return t}})(a),a})(Zt,Se,tn),on=(e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(ze),rn=((e,t,n)=>async(o,r,a,i)=>{const s=e(o),c=[...i,o];await Promise.all(s.activeInputs.map(((e,i)=>Array.from(e).filter((([e])=>!c.includes(e))).map((async([e,s])=>{const u=t(e),l=await u.render(e,r,c),h=o.context.destination;n(e)||o===h&&n(o)||l.connect(a,s,i)})))).reduce(((e,t)=>[...e,...t]),[]))})(ze,on,$e),an=((e,t,n)=>()=>{const o=new WeakMap;return{render(r,a,i){const s=o.get(a);return void 0!==s?Promise.resolve(s):(async(r,a,i)=>{let s=t(r);if(!xe(s,a)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,fftSize:s.fftSize,maxDecibels:s.maxDecibels,minDecibels:s.minDecibels,smoothingTimeConstant:s.smoothingTimeConstant};s=e(a,t)}return o.set(a,s),await n(r,a,s,i),s})(r,a,i)}}})(nn,Ze,rn),sn=new WeakMap,cn=(un=ve,e=>{const t=un.get(e);if(void 0===t)throw Tt();return t});var un;const ln=new WeakMap,hn=(e=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(t,n,o){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=e(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(t,r,o)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const o=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===o?null:o,n)}})(Gt),dn=(e=>t=>null!==e&&t instanceof e)(Kt),fn=(e=>t=>null!==e&&"function"==typeof e.AudioNode&&t instanceof e.AudioNode)(Ht),pn=(e=>t=>null!==e&&"function"==typeof e.AudioParam&&t instanceof e.AudioParam)(Ht),mn=((e,t,n,o,r,a,i,s,c,u,l,h,d,f,p)=>class extends u{constructor(t,o,r,a){super(r),this._context=t,this._nativeAudioNode=r;const i=l(t);h(i)&&!0!==n(tt,(()=>tt(i)))&&(e=>{const t=new Map;var n,o;e.connect=(n=e.connect.bind(e),(e,o=0,r=0)=>{const a=ot(e)?n(e,o,r):n(e,o),i=t.get(e);return void 0===i?t.set(e,[{input:r,output:o}]):i.every((e=>e.input!==r||e.output!==o))&&i.push({input:r,output:o}),a}),e.disconnect=(o=e.disconnect,(n,r,a)=>{if(o.apply(e),void 0===n)t.clear();else if("number"==typeof n)for(const[e,o]of t){const r=o.filter((e=>e.output!==n));0===r.length?t.delete(e):t.set(e,r)}else if(t.has(n))if(void 0===r)t.delete(n);else{const e=t.get(n);if(void 0!==e){const o=e.filter((e=>e.output!==r&&(e.input!==a||void 0===a)));0===o.length?t.delete(n):t.set(n,o)}}for(const[n,o]of t)o.forEach((t=>{ot(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)}))})})(r),de.set(this,r),ge.set(this,new Set),o&&Re(this),e(this,a,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,n=0,s=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw r();const u=l(this._context),h=p(u);if(d(e)||f(e))throw a();if(Be(e)){const r=Ze(e);try{const o=Ye(this._nativeAudioNode,r,n,s);if(h||Je(this)?this._nativeAudioNode.disconnect(...o):Je(e)&&Re(e),We(e)){const e=t.get(r);if(void 0===e){const e=u.createGain();e.connect(o[0],0,o[2]),t.set(r,new Map([[s,e]]))}else if(void 0===e.get(s)){const t=u.createGain();t.connect(o[0],0,o[2]),e.set(s,t)}}}catch(e){if(12===e.code)throw a();throw e}if(h?((e,t,n,o)=>{const{outputs:r}=ze(e);if(Qe(r,[t,n,o],(e=>e[0]===t&&e[1]===n&&e[2]===o),!0)){const{activeInputs:r}=ze(t);return rt(r,e,[n,o,null],!0),!0}return!1})(this,e,n,s):lt(this,e,n,s)){const t=c([this],e);nt(t,o(h))}return e}const m=Ue(e);if("playbackRate"===m.name)throw i();try{this._nativeAudioNode.connect(m,n),(h||Je(this))&&this._nativeAudioNode.disconnect(m,n)}catch(e){if(12===e.code)throw a();throw e}if(h?((e,t,n)=>{const{outputs:o}=ze(e);if(Qe(o,[t,n],(e=>e[0]===t&&e[1]===n),!0)){const{activeInputs:o}=Ge(t);return at(o,e,[n,null],!0),!0}return!1})(this,e,n):ht(this,e,n)){const t=c([this],e);nt(t,o(h))}}disconnect(e,t,n){let o;if(void 0===e)o=(e=>{const t=ze(e),n=[];for(const o of t.outputs)Le(o)?ft(e,...o):pt(e,...o),n.push(o[0]);return t.outputs.clear(),n})(this);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw r();o=((e,t)=>{const n=ze(e),o=[];for(const r of n.outputs)r[1]===t&&(Le(r)?ft(e,...r):pt(e,...r),o.push(r[0]),n.outputs.delete(r));return o})(this,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw r();if(Be(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw r();if(o=((e,t,n,o)=>{const r=ze(e);return Array.from(r.outputs).filter((e=>!(e[0]!==t||void 0!==n&&e[1]!==n||void 0!==o&&e[2]!==o))).map((t=>(Le(t)?ft(e,...t):pt(e,...t),r.outputs.delete(t),t[0])))})(this,e,t,n),0===o.length)throw a()}for(const e of o){const t=c([this],e);nt(t,s)}}})((vn=he,(e,t,n)=>{const o=[];for(let e=0;e<n.numberOfInputs;e+=1)o.push(new Set);vn.set(e,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),sn,Zt,((e,t,n,o,r,a)=>i=>(s,c)=>{const u=e.get(s);if(void 0===u){if(!i&&a(s)){const e=o(s),{outputs:a}=n(s);for(const n of a)if(Le(n)){const r=o(n[0]);t(e,r,n[1],n[2])}else{const t=r(n[0]);e.disconnect(t,n[1])}}e.set(s,c)}else e.set(s,u+c)})(ye,Xe,ze,Ze,Ue,He),Se,It,Bt,((e,t,n,o,r,a,i,s)=>(c,u)=>{const l=t.get(c);if(void 0===l)throw new Error("Missing the expected cycle count.");const h=a(c.context),d=s(h);if(l===u){if(t.delete(c),!d&&i(c)){const t=o(c),{outputs:a}=n(c);for(const n of a)if(Le(n)){const r=o(n[0]);e(t,r,n[1],n[2])}else{const e=r(n[0]);t.connect(e,n[1])}}}else t.set(c,l-u)})(Ye,ye,ze,Ze,Ue,cn,He,Jt),((e,t,n)=>function o(r,a){const i=Be(a)?a:n(e,a);if((e=>"delayTime"in e)(i))return[];if(r[0]===i)return[r];if(r.includes(i))return[];const{outputs:s}=t(i);return Array.from(s).map((e=>o([...r,i],e[0]))).reduce(((e,t)=>e.concat(t)),[])})(ln,ze,De),hn,cn,dn,fn,pn,Jt);var vn;const gn=((e,t,n,o,r,a)=>class extends e{constructor(e,n=Me){const i=r(e),s={...Me,...n},c=o(i,s);super(e,!1,c,a(i)?t():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){const t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){const t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}})(mn,an,Se,nn,cn,Jt),yn=new WeakSet,wn=(e=>null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null)(Ht),Cn=(_n=new Uint32Array(1),e=>(_n[0]=e,_n[0]));var _n;const bn=((e,t)=>n=>{n.copyFromChannel=(o,r,a=0)=>{const i=e(a),s=e(r);if(s>=n.numberOfChannels)throw t();const c=n.length,u=n.getChannelData(s),l=o.length;for(let e=i<0?-i:0;e+i<c&&e<l;e+=1)o[e]=u[e+i]},n.copyToChannel=(o,r,a=0)=>{const i=e(a),s=e(r);if(s>=n.numberOfChannels)throw t();const c=n.length,u=n.getChannelData(s),l=o.length;for(let e=i<0?-i:0;e+i<c&&e<l;e+=1)u[e+i]=o[e]}})(Cn,Se),Tn=(e=>t=>{var n,o;t.copyFromChannel=(n=t.copyFromChannel,(o,r,a=0)=>{const i=e(a),s=e(r);if(i<t.length)return n.call(t,o,s,i)}),t.copyToChannel=(o=t.copyToChannel,(n,r,a=0)=>{const i=e(a),s=e(r);if(i<t.length)return o.call(t,n,s,i)})})(Cn),In=((e,t,n,o,r,a,i,s)=>{let c=null;return class u{constructor(u){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:d}={...Oe,...u};null===c&&(c=new r(1,1,44100));const f=null!==o&&t(a,a)?new o({length:l,numberOfChannels:h,sampleRate:d}):c.createBuffer(h,l,d);if(0===f.numberOfChannels)throw n();return"function"!=typeof f.copyFromChannel?(i(f),Ne(f)):t(Ae,(()=>Ae(f)))||s(f),e.add(f),f}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===u.prototype||e.has(t)}}})(yn,Zt,Bt,wn,$t,(e=>()=>{if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0})(wn),bn,Tn),Mn=(e=>(t,n)=>{const o=e(t,(e=>e.createGain()));return Ot(o,n),Et(o,n,"gain"),o})(tn),xn=(e=>(t,n)=>{const o=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(o).connect(o.context.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(o),o.disconnect()};n.addEventListener("ended",r)})(Mn),An=(e=>t=>{const n=e(t,(e=>e.createOscillator()));try{n.start(-1)}catch(e){return e instanceof RangeError}return!1})(tn),Sn=(e=>t=>{const n=t.createBuffer(1,1,44100),o=e(t,(e=>e.createBufferSource()));o.buffer=n,o.start(),o.stop();try{return o.stop(),!0}catch{return!1}})(tn),Nn=(e=>t=>{const n=e(t,(e=>e.createOscillator()));try{n.stop(-1)}catch(e){return e instanceof RangeError}return!1})(tn),On=(e=>(t,n)=>{const o=e(n,(e=>e.createGain()));t.connect(o);const r=(a=t.disconnect,()=>{a.call(t,o),t.removeEventListener("ended",r)});var a;t.addEventListener("ended",r),Rt(t,o),t.stop=(e=>{let n=!1;return(r=0)=>{if(n)try{e.call(t,r)}catch{o.gain.setValueAtTime(0,r)}else e.call(t,r),n=!0}})(t.stop)})(tn),kn=((e,t,n)=>async(o,r,a,i)=>{const s=t(o);await Promise.all(Array.from(s.activeInputs).map((async([t,o])=>{const s=e(t),c=await s.render(t,r,i);n(t)||c.connect(a,o)})))})(on,Ge,$e),En=(e=>(t,n,o,r)=>e(n,t,o,r))(kn),Dn=((e,t,n,o,r,a,i,s,c,u,l,h,d)=>(f,p)=>{const m=n(f,(e=>e.createBufferSource()));return Ot(m,p),Et(m,p,"playbackRate"),Nt(m,p,"buffer"),Nt(m,p,"loop"),Nt(m,p,"loopEnd"),Nt(m,p,"loopStart"),t(o,(()=>o(f)))||(e=>{e.start=(t=>{let n=!1;return(o=0,r=0,a)=>{if(n)throw Tt();t.call(e,o,r,a),n=!0}})(e.start)})(m),t(r,r)||((e,t)=>{let n=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;var r,a;e.start=(r=e.start,a=e.stop,(i=0,s=0,c=Number.POSITIVE_INFINITY)=>{if(r.call(e,i,s),c>=0&&c<Number.POSITIVE_INFINITY){const r=Math.max(i,t.currentTime),s=c/e.playbackRate.value;n=r+s,a.call(e,Math.min(n,o))}}),e.stop=(r=>(a=0)=>{o=Math.max(a,t.currentTime),r.call(e,Math.min(n,o))})(e.stop)})(m,f),t(a,(()=>a(f)))||l(m),t(i,(()=>i(f)))||h(m,f),t(s,(()=>s(f)))||Dt(m),t(c,(()=>c(f)))||d(m,f),t(u,(()=>u(f)))||Pt(m),e(f,m),m})(xn,Zt,tn,(e=>t=>{const n=e(t,(e=>e.createBufferSource()));n.start();try{n.start()}catch{return!0}return!1})(tn),(e=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100),n=t.createBuffer(1,1,t.sampleRate),o=t.createBufferSource();return n.getChannelData(0)[0]=1,o.buffer=n,o.start(0,0,0),o.connect(t.destination),new Promise((e=>{t.oncomplete=({renderedBuffer:t})=>{e(0===t.getChannelData(0)[0])},t.startRendering()}))})($t),(e=>t=>{const n=e(t,(e=>e.createBufferSource())),o=t.createBuffer(1,1,44100);n.buffer=o;try{n.start(0,1)}catch{return!1}return!0})(tn),(e=>t=>{const n=e(t,(e=>e.createBufferSource()));n.start();try{n.stop()}catch{return!1}return!0})(tn),An,Sn,Nn,(e=>{var t;e.start=(t=e.start,(n=0,o=0,r)=>{const a=e.buffer,i=null===a?o:Math.min(a.duration,o);null!==a&&i>a.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,i,r)})}),(e=>(t,n)=>{const o=n.createBuffer(1,1,n.sampleRate);null===t.buffer&&(t.buffer=o),e(t,"buffer",(e=>()=>{const n=e.call(t);return n===o?null:n}),(e=>n=>e.call(t,null===n?o:n)))})(zt),On),Pn=((e,t)=>(n,o,r,a)=>(e(o).replay(r),t(o,n,r,a)))((e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(Ge),kn),Rn=((e,t,n,o,r)=>()=>{const a=new WeakMap;let i=null,s=null;return{set start(e){i=e},set stop(e){s=e},render(c,u,l){const h=a.get(u);return void 0!==h?Promise.resolve(h):(async(c,u,l)=>{let h=n(c);const d=xe(h,u);if(!d){const e={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=t(u,e),null!==i&&h.start(...i),null!==s&&h.stop(s)}return a.set(u,h),d?await e(u,c.playbackRate,h.playbackRate,l):await o(u,c.playbackRate,h.playbackRate,l),await r(c,u,h,l),h})(c,u,l)}}})(En,Dn,Ze,Pn,rn),Vn=((e,t,n,o,r,a,i,s,c,u,l,h)=>(d,f,p,m=null,v=null)=>{const g=new ue(p.defaultValue),y=f?o(g):null,w={get defaultValue(){return p.defaultValue},get maxValue(){return null===m?p.maxValue:m},get minValue(){return null===v?p.minValue:v},get value(){return p.value},set value(e){p.value=e,w.setValueAtTime(e,d.context.currentTime)},cancelAndHoldAtTime(e){if("function"==typeof p.cancelAndHoldAtTime)null===y&&g.flush(d.context.currentTime),g.add(r(e)),p.cancelAndHoldAtTime(e);else{const t=Array.from(g).pop();null===y&&g.flush(d.context.currentTime),g.add(r(e));const n=Array.from(g).pop();p.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?p.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?p.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?p.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&p.setValueCurveAtTime(n.values,n.startTime,n.duration))}return w},cancelScheduledValues:e=>(null===y&&g.flush(d.context.currentTime),g.add(a(e)),p.cancelScheduledValues(e),w),exponentialRampToValueAtTime:(e,t)=>(null===y&&g.flush(d.context.currentTime),g.add(i(e,t)),p.exponentialRampToValueAtTime(e,t),w),linearRampToValueAtTime:(e,t)=>(null===y&&g.flush(d.context.currentTime),g.add(s(e,t)),p.linearRampToValueAtTime(e,t),w),setTargetAtTime:(e,t,n)=>(null===y&&g.flush(d.context.currentTime),g.add(c(e,t,n)),p.setTargetAtTime(e,t,n),w),setValueAtTime:(e,t)=>(null===y&&g.flush(d.context.currentTime),g.add(u(e,t)),p.setValueAtTime(e,t),w),setValueCurveAtTime(e,t,n){if(null!==h&&"webkitAudioContext"===h.name){const o=t+n,r=d.context.sampleRate,a=Math.ceil(t*r),i=Math.floor(o*r),s=i-a,c=new Float32Array(s);for(let o=0;o<s;o+=1){const i=(e.length-1)/n*((a+o)/r-t),s=Math.floor(i),u=Math.ceil(i);c[o]=s===u?e[s]:(1-(i-s))*e[s]+(1-(u-i))*e[u]}null===y&&g.flush(d.context.currentTime),g.add(l(c,t,n)),p.setValueCurveAtTime(c,t,n);const u=i/r;u<o&&w.setValueAtTime(c[c.length-1],u),w.setValueAtTime(e[e.length-1],o)}else null===y&&g.flush(d.context.currentTime),g.add(l(e,t,n)),p.setValueCurveAtTime(e,t,n);return w}};return n.set(w,p),t.set(w,d),e(w,y),w})((Fn=fe,(e,t)=>{Fn.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),ln,pe,(e=>({replay(t){for(const n of e)if("exponentialRampToValue"===n.type){const{endTime:e,value:o}=n;t.exponentialRampToValueAtTime(o,e)}else if("linearRampToValue"===n.type){const{endTime:e,value:o}=n;t.linearRampToValueAtTime(o,e)}else if("setTarget"===n.type){const{startTime:e,target:o,timeConstant:r}=n;t.setTargetAtTime(o,e,r)}else if("setValue"===n.type){const{startTime:e,value:o}=n;t.setValueAtTime(o,e)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:e,startTime:o,values:r}=n;t.setValueCurveAtTime(r,o,e)}}}})),(e=>({cancelTime:e,type:"cancelAndHold"})),(e=>({cancelTime:e,type:"cancelScheduledValues"})),((e,t)=>({endTime:t,type:"exponentialRampToValue",value:e})),((e,t)=>({endTime:t,type:"linearRampToValue",value:e})),((e,t,n)=>({startTime:t,target:e,timeConstant:n,type:"setTarget"})),G,Z,Kt);var Fn;const Bn=((e,t,n,o,r,a,i,s)=>class extends e{constructor(e,o=Fe){const s=a(e),c={...Fe,...o},u=r(s,c),l=i(s),h=l?t():null;super(e,!1,u,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==o.buffer&&void 0!==o.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,l,u.playbackRate,Ee,ke)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){try{this._nativeAudioBufferSourceNode.buffer=e}catch(t){if(null!==e||17!==t.code)throw t;if(null!==this._nativeAudioBufferSourceNode.buffer){const e=this._nativeAudioBufferSourceNode.buffer,t=e.numberOfChannels;for(let n=0;n<t;n+=1)e.getChannelData(n).fill(0);this._isBufferNullified=!0}}if(null!==e){if(this._isBufferSet)throw o();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){const t="function"==typeof e?s(this,e):null;this._nativeAudioBufferSourceNode.onended=t;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}get playbackRate(){return this._playbackRate}start(e=0,t=0,n){if(this._nativeAudioBufferSourceNode.start(e,t,n),null!==this._audioBufferSourceNodeRenderer)this._audioBufferSourceNodeRenderer.start=void 0===n?[e,t]:[e,t,n];else{Re(this);const e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),setTimeout((()=>Ve(this)),1e3)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}})(mn,Rn,Vn,Tt,Dn,cn,Jt,Gt),Ln=((e,t,n,o,r,a,i,s)=>class extends e{constructor(e,n){const o=a(e),c=i(o),u=r(o,n,c);super(e,!1,u,c?t(s):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=u}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw o();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw o();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(mn,(e=>{let t=null;return{render:(n,o,r)=>(null===t&&(t=(async(t,n,o)=>{const r=n.destination;return await e(t,n,r,o),r})(n,o,r)),t)}}),Se,Tt,((e,t)=>(n,o,r)=>{const a=n.destination;if(a.channelCount!==o)try{a.channelCount=o}catch{}r&&"explicit"!==a.channelCountMode&&(a.channelCountMode="explicit"),0===a.maxChannelCount&&Object.defineProperty(a,"maxChannelCount",{value:o});const i=e(n,{channelCount:o,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return t(i,"channelCount",(e=>()=>e.call(i)),(e=>t=>{e.call(i,t);try{a.channelCount=t}catch(e){if(t>a.maxChannelCount)throw e}})),t(i,"channelCountMode",(e=>()=>e.call(i)),(e=>t=>{e.call(i,t),a.channelCountMode=t})),t(i,"channelInterpretation",(e=>()=>e.call(i)),(e=>t=>{e.call(i,t),a.channelInterpretation=t})),Object.defineProperty(i,"maxChannelCount",{get:()=>a.maxChannelCount}),i.connect(a),i})(Mn,zt),cn,Jt,rn),Wn=(e=>(t,n)=>{const o=e(t,(e=>e.createBiquadFilter()));return Ot(o,n),Et(o,n,"Q"),Et(o,n,"detune"),Et(o,n,"frequency"),Et(o,n,"gain"),Nt(o,n,"type"),o})(tn),jn=((e,t,n,o,r)=>()=>{const a=new WeakMap;return{render(i,s,c){const u=a.get(s);return void 0!==u?Promise.resolve(u):(async(i,s,c)=>{let u=n(i);const l=xe(u,s);if(!l){const e={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=t(s,e)}return a.set(s,u),l?(await e(s,i.Q,u.Q,c),await e(s,i.detune,u.detune,c),await e(s,i.frequency,u.frequency,c),await e(s,i.gain,u.gain,c)):(await o(s,i.Q,u.Q,c),await o(s,i.detune,u.detune,c),await o(s,i.frequency,u.frequency,c),await o(s,i.gain,u.gain,c)),await r(i,s,u,c),u})(i,s,c)}}})(En,Wn,Ze,Pn,rn),Yn=((e,t,n,o,r,a,i)=>class extends e{constructor(e,o=mt){const s=a(e),c={...mt,...o},u=r(s,c),l=i(s);super(e,!1,u,l?n():null),this._Q=t(this,l,u.Q,Ee,ke),this._detune=t(this,l,u.detune,1200*Math.log2(Ee),-1200*Math.log2(Ee)),this._frequency=t(this,l,u.frequency,e.sampleRate/2,0),this._gain=t(this,l,u.gain,40*Math.log10(Ee),ke),this._nativeBiquadFilterNode=u}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n),e.length!==t.length||t.length!==n.length)throw o()}})(mn,Vn,jn,It,Wn,cn,Jt),qn=((e,t)=>(n,o,r)=>{const a=new Set;var i,s;return n.connect=(i=n.connect,(r,s=0,c=0)=>{const u=0===a.size;if(t(r))return i.call(n,r,s,c),e(a,[r,s,c],(e=>e[0]===r&&e[1]===s&&e[2]===c),!0),u&&o(),r;i.call(n,r,s),e(a,[r,s],(e=>e[0]===r&&e[1]===s),!0),u&&o()}),n.disconnect=(s=n.disconnect,(e,o,i)=>{const c=a.size>0;if(void 0===e)s.apply(n),a.clear();else if("number"==typeof e){s.call(n,e);for(const t of a)t[1]===e&&a.delete(t)}else{t(e)?s.call(n,e,o,i):s.call(n,e,o);for(const t of a)t[0]!==e||void 0!==o&&t[1]!==o||void 0!==i&&t[2]!==i||a.delete(t)}const u=0===a.size;c&&u&&r()}),n})(Qe,fn),Xn=((e,t,n)=>(o,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const a=t(o,(e=>e.createBufferSource()));n(r,(()=>{const e=r.numberOfInputs;for(let t=0;t<e;t+=1)a.connect(r,0,t)}),(()=>a.disconnect(r)))})(Tt,tn,qn),zn=((e,t)=>(n,o)=>{const r=e(n,(e=>e.createChannelMerger(o.numberOfInputs)));return 1!==r.channelCount&&"explicit"!==r.channelCountMode&&t(n,r),Ot(r,o),r})(tn,Xn),Gn=((e,t,n)=>()=>{const o=new WeakMap;return{render(r,a,i){const s=o.get(a);return void 0!==s?Promise.resolve(s):(async(r,a,i)=>{let s=t(r);if(!xe(s,a)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfInputs:s.numberOfInputs};s=e(a,t)}return o.set(a,s),await n(r,a,s,i),s})(r,a,i)}}})(zn,Ze,rn),Zn=((e,t,n,o,r)=>class extends e{constructor(e,a=vt){const i=o(e),s={...vt,...a};super(e,!1,n(i,s),r(i)?t():null)}})(mn,Gn,zn,cn,Jt),Un=(e=>(t,n)=>{const o=e(t,(e=>e.createChannelSplitter(n.numberOfOutputs)));return Ot(o,n),(e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Tt()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw Tt()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw Tt()}})})(o),o})(tn),Qn=((e,t,n)=>()=>{const o=new WeakMap;return{render(r,a,i){const s=o.get(a);return void 0!==s?Promise.resolve(s):(async(r,a,i)=>{let s=t(r);if(!xe(s,a)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfOutputs:s.numberOfOutputs};s=e(a,t)}return o.set(a,s),await n(r,a,s,i),s})(r,a,i)}}})(Un,Ze,rn),Hn=((e,t,n,o,r)=>class extends e{constructor(e,a=gt){const i=o(e),s=(e=>({...e,channelCount:e.numberOfOutputs}))({...gt,...a});super(e,!1,n(i,s),r(i)?t():null)}})(mn,Qn,Un,cn,Jt),$n=((e,t,n,o)=>(r,{offset:a,...i})=>{const s=r.createBuffer(1,2,r.sampleRate),c=t(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(r,{...i,gain:a}),l=s.getChannelData(0);l[0]=1,l[1]=1,c.buffer=s,c.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(e){u.channelCount=e},get channelCountMode(){return u.channelCountMode},set channelCountMode(e){u.channelCountMode=e},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(e){u.channelInterpretation=e},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(e){c.onended=e},addEventListener:(...e)=>c.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>c.dispatchEvent(e[0]),removeEventListener:(...e)=>c.removeEventListener(e[0],e[1],e[2]),start(e=0){c.start.call(c,e)},stop(e=0){c.stop.call(c,e)}};return e(r,c),o(Rt(h,u),(()=>c.connect(u)),(()=>c.disconnect(u)))})(xn,Dn,Mn,qn),Jn=((e,t,n,o,r,a)=>(i,s)=>{if(void 0===i.createConstantSource)return o(i,s);const c=n(i,(e=>e.createConstantSource()));return Ot(c,s),Et(c,s,"offset"),t(r,(()=>r(i)))||Dt(c),t(a,(()=>a(i)))||Pt(c),e(i,c),c})(xn,Zt,tn,$n,An,Nn),Kn=((e,t,n,o,r)=>()=>{const a=new WeakMap;let i=null,s=null;return{set start(e){i=e},set stop(e){s=e},render(c,u,l){const h=a.get(u);return void 0!==h?Promise.resolve(h):(async(c,u,l)=>{let h=n(c);const d=xe(h,u);if(!d){const e={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=t(u,e),null!==i&&h.start(i),null!==s&&h.stop(s)}return a.set(u,h),d?await e(u,c.offset,h.offset,l):await o(u,c.offset,h.offset,l),await r(c,u,h,l),h})(c,u,l)}}})(En,Jn,Ze,Pn,rn),eo=((e,t,n,o,r,a,i)=>class extends e{constructor(e,i=yt){const s=r(e),c={...yt,...i},u=o(s,c),l=a(s),h=l?n():null;super(e,!1,u,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=u,this._offset=t(this,l,u.offset,Ee,ke),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){const t="function"==typeof e?i(this,e):null;this._nativeConstantSourceNode.onended=t;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer)this._constantSourceNodeRenderer.start=e;else{Re(this);const e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),setTimeout((()=>Ve(this)),1e3)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}})(mn,Vn,Kn,Jn,cn,Jt,Gt),to=((e,t,n)=>(o,{buffer:r,channelCount:a,channelCountMode:i,channelInterpretation:s,disableNormalization:c})=>{const u=e(o,(e=>e.createConvolver()));Ot(u,{channelCount:Math.max(a,2),channelCountMode:"max"===i?i:"clamped-max",channelInterpretation:s});const l=t(o,{channelCount:a,channelCountMode:i,channelInterpretation:s,gain:1}),h={get buffer(){return u.buffer},set buffer(e){u.buffer=e},get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){e>2&&(u.channelCount=e),l.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){"max"===e&&(u.channelCountMode=e),l.channelCountMode=e},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(e){u.channelInterpretation=e,l.channelInterpretation=e},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get normalize(){return u.normalize},set normalize(e){u.normalize=e},addEventListener:(...e)=>u.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>u.dispatchEvent(e[0]),removeEventListener:(...e)=>u.removeEventListener(e[0],e[1],e[2])};c===h.normalize&&(h.normalize=!c),r!==h.buffer&&(h.buffer=r);return n(Rt(h,l),(()=>u.connect(l)),(()=>u.disconnect(l)))})(tn,Mn,qn),no=((e,t,n,o)=>(r,a)=>{const i=e(r,(e=>e.createConvolver()));try{i.channelCount=1}catch(e){return t(r,a)}if(Ot(i,a),a.disableNormalization===i.normalize&&(i.normalize=!a.disableNormalization),Nt(i,a,"buffer"),a.channelCount>2)throw n();if(o(i,"channelCount",(e=>()=>e.call(i)),(e=>t=>{if(t>2)throw n();return e.call(i,t)})),"max"===a.channelCountMode)throw n();return o(i,"channelCountMode",(e=>()=>e.call(i)),(e=>t=>{if("max"===t)throw n();return e.call(i,t)})),i})(tn,to,Bt,zt),oo=((e,t,n)=>()=>{const o=new WeakMap;return{render(r,a,i){const s=o.get(a);return void 0!==s?Promise.resolve(s):(async(r,a,i)=>{let s=t(r);if(!xe(s,a)){const t={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,disableNormalization:!s.normalize};s=e(a,t)}return o.set(a,s),je(s)?await n(r,a,s.inputs[0],i):await n(r,a,s,i),s})(r,a,i)}}})(no,Ze,rn),ro=((e,t,n,o,r)=>class extends e{constructor(e,a=wt){const i=o(e),s={...wt,...a},c=n(i,s);super(e,!1,c,r(i)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=c}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){const e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0}else this._isBufferNullified=!1}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}})(mn,oo,no,cn,Jt),ao=(e=>(t,n)=>{const o=e(t,(e=>e.createDelay(n.maxDelayTime)));return Ot(o,n),Et(o,n,"delayTime"),o})(tn),io=((e,t,n,o,r)=>a=>{const i=new WeakMap;return{render(s,c,u){const l=i.get(c);return void 0!==l?Promise.resolve(l):(async(s,c,u)=>{let l=n(s);const h=xe(l,c);if(!h){const e={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:a};l=t(c,e)}return i.set(c,l),h?await e(c,s.delayTime,l.delayTime,u):await o(c,s.delayTime,l.delayTime,u),await r(s,c,l,u),l})(s,c,u)}}})(En,ao,Ze,Pn,rn),so=((e,t,n,o,r,a)=>class extends e{constructor(e,i=Ct){const s=r(e),c={...Ct,...i},u=o(s,c),l=a(s);super(e,!1,u,l?n(c.maxDelayTime):null),this._delayTime=t(this,l,u.delayTime,c.maxDelayTime,0)}get delayTime(){return this._delayTime}})(mn,Vn,io,ao,cn,Jt),co=((e,t)=>(n,o)=>{const r=e(n,(e=>e.createDynamicsCompressor()));if(Ot(r,o),o.channelCount>2)throw t();if("max"===o.channelCountMode)throw t();return Et(r,o,"attack"),Et(r,o,"knee"),Et(r,o,"ratio"),Et(r,o,"release"),Et(r,o,"threshold"),r})(tn,Bt),uo=((e,t,n,o,r)=>()=>{const a=new WeakMap;return{render(i,s,c){const u=a.get(s);return void 0!==u?Promise.resolve(u):(async(i,s,c)=>{let u=n(i);const l=xe(u,s);if(!l){const e={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=t(s,e)}return a.set(s,u),l?(await e(s,i.attack,u.attack,c),await e(s,i.knee,u.knee,c),await e(s,i.ratio,u.ratio,c),await e(s,i.release,u.release,c),await e(s,i.threshold,u.threshold,c)):(await o(s,i.attack,u.attack,c),await o(s,i.knee,u.knee,c),await o(s,i.ratio,u.ratio,c),await o(s,i.release,u.release,c),await o(s,i.threshold,u.threshold,c)),await r(i,s,u,c),u})(i,s,c)}}})(En,co,Ze,Pn,rn),lo=((e,t,n,o,r,a,i)=>class extends e{constructor(e,r=_t){const s=a(e),c={..._t,...r},u=o(s,c),l=i(s);super(e,!1,u,l?n():null),this._attack=t(this,l,u.attack,1,0),this._knee=t(this,l,u.knee,40,0),this._nativeDynamicsCompressorNode=u,this._ratio=t(this,l,u.ratio,20,1),this._release=t(this,l,u.release,1,0),this._threshold=t(this,l,u.threshold,0,-100)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){const t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){const t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(mn,Vn,uo,co,Bt,cn,Jt),ho=((e,t,n,o,r)=>()=>{const a=new WeakMap;return{render(i,s,c){const u=a.get(s);return void 0!==u?Promise.resolve(u):(async(i,s,c)=>{let u=n(i);const l=xe(u,s);if(!l){const e={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=t(s,e)}return a.set(s,u),l?await e(s,i.gain,u.gain,c):await o(s,i.gain,u.gain,c),await r(i,s,u,c),u})(i,s,c)}}})(En,Mn,Ze,Pn,rn),fo=((e,t,n,o,r,a)=>class extends e{constructor(e,i=bt){const s=r(e),c={...bt,...i},u=o(s,c),l=a(s);super(e,!1,u,l?n():null),this._gain=t(this,l,u.gain,Ee,ke)}get gain(){return this._gain}})(mn,Vn,ho,Mn,cn,Jt),po=(e=>(t,n,o,r)=>e(t,(e=>e.createScriptProcessor(n,o,r))))(tn),mo=((e,t,n,o)=>(r,a,{channelCount:i,channelCountMode:s,channelInterpretation:c,feedback:u,feedforward:l})=>{const h=((e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))))(a,r.sampleRate),d=u.length,f=l.length,p=Math.min(d,f);if(0===u.length||u.length>20)throw o();if(0===u[0])throw t();if(0===l.length||l.length>20)throw o();if(0===l[0])throw t();if(1!==u[0]){for(let e=0;e<f;e+=1)l[e]/=u[0];for(let e=1;e<d;e+=1)u[e]/=u[0]}const m=n(r,h,i,i);m.channelCount=i,m.channelCountMode=s,m.channelInterpretation=c;const v=[],g=[],y=[];for(let e=0;e<i;e+=1){v.push(0);const e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),g.push(e),y.push(t)}m.onaudioprocess=e=>{const t=e.inputBuffer,n=e.outputBuffer,o=t.numberOfChannels;for(let e=0;e<o;e+=1){const o=t.getChannelData(e),r=n.getChannelData(e);v[e]=xt(u,d,l,f,p,g[e],y[e],v[e],32,o,r)}};const w=r.sampleRate/2;return Rt({get bufferSize(){return h},get channelCount(){return m.channelCount},set channelCount(e){m.channelCount=e},get channelCountMode(){return m.channelCountMode},set channelCountMode(e){m.channelCountMode=e},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(e){m.channelInterpretation=e},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},addEventListener:(...e)=>m.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>m.dispatchEvent(e[0]),getFrequencyResponse(t,n,o){if(t.length!==n.length||n.length!==o.length)throw e();const r=t.length;for(let e=0;e<r;e+=1){const r=-Math.PI*(t[e]/w),a=[Math.cos(r),Math.sin(r)],i=Vt(Ft(l,a),Ft(u,a));n[e]=Math.sqrt(i[0]*i[0]+i[1]*i[1]),o[e]=Math.atan2(i[1],i[0])}},removeEventListener:(...e)=>m.removeEventListener(e[0],e[1],e[2])},m)})(It,Tt,po,Bt),vo=((e,t,n,o)=>r=>e(St,(()=>St(r)))?Promise.resolve(e(o,o)).then((e=>{if(!e){const e=n(r,512,0,1);r.oncomplete=()=>{e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=()=>r.currentTime,e.connect(r.destination)}return r.startRendering()})):new Promise((e=>{const n=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=t=>{n.disconnect(),e(t.renderedBuffer)},n.connect(r.destination),r.startRendering()})))(Zt,Mn,po,((e,t)=>()=>{if(null===t)return Promise.resolve(!1);const n=new t(1,1,44100),o=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((e=>{n.oncomplete=()=>{o.disconnect(),e(0!==n.currentTime)},n.startRendering()}))})(Mn,$t)),go=((e,t,n,o,r,a)=>(i,s)=>{const c=new WeakMap;let u=null;const l=async(l,h,d)=>{let f=null,p=n(l);const m=xe(p,h);if(void 0===h.createIIRFilter?f=e(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(p=t(h,(e=>e.createIIRFilter(s,i)))),c.set(h,null===f?p:f),null!==f){if(null===u){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new o(l.context.destination.channelCount,l.context.length,h.sampleRate);u=(async()=>{await r(l,e,e.destination,d);return((e,t,n,o)=>{const r=n.length,a=o.length,i=Math.min(r,a);if(1!==n[0]){for(let e=0;e<r;e+=1)o[e]/=n[0];for(let e=1;e<a;e+=1)n[e]/=n[0]}const s=new Float32Array(32),c=new Float32Array(32),u=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),l=e.numberOfChannels;for(let t=0;t<l;t+=1){const l=e.getChannelData(t),h=u.getChannelData(t);s.fill(0),c.fill(0),xt(n,r,o,a,i,s,c,0,32,l,h)}return u})(await a(e),h,i,s)})()}const e=await u;return f.buffer=e,f.start(0),f}return await r(l,h,p,d),p};return{render(e,t,n){const o=c.get(t);return void 0!==o?Promise.resolve(o):l(e,t,n)}}})(Dn,tn,Ze,$t,rn,vo),yo=((e,t)=>(n,o,r)=>{if(void 0===n.createIIRFilter)return t(n,o,r);const a=e(n,(e=>e.createIIRFilter(r.feedforward,r.feedback)));return Ot(a,r),a})(tn,mo),wo=((e,t,n,o,r)=>class extends e{constructor(e,a){const i=o(e),s=r(i),c={...Mt,...a},u=t(i,s?null:e.baseLatency,c);super(e,!1,u,s?n(c.feedback,c.feedforward):null),(e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(n,o,r)=>{if(n.length!==o.length||o.length!==r.length)throw It();return t.call(e,n,o,r)})})(u),this._nativeIIRFilterNode=u}getFrequencyResponse(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}})(mn,yo,go,cn,Jt),Co=((e,t,n,o,r)=>(a,i)=>{const s=i.listener,{forwardX:c,forwardY:u,forwardZ:l,positionX:h,positionY:d,positionZ:f,upX:p,upY:m,upZ:v}=void 0===s.forwardX?(()=>{const c=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),u=r(i),l=o(i,256,9,0),h=(t,o)=>{const r=n(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:o});return r.connect(c,0,t),r.start(),Object.defineProperty(r.offset,"defaultValue",{get:()=>o}),e({context:a},u,r.offset,Ee,ke)};let d=[0,0,-1,0,1,0],f=[0,0,0];return l.onaudioprocess=({inputBuffer:e})=>{const t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0],e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];t.some(((e,t)=>e!==d[t]))&&(s.setOrientation(...t),d=t);const n=[e.getChannelData(6)[0],e.getChannelData(7)[0],e.getChannelData(8)[0]];n.some(((e,t)=>e!==f[t]))&&(s.setPosition(...n),f=n)},c.connect(l),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}})():s;return{get forwardX(){return c},get forwardY(){return u},get forwardZ(){return l},get positionX(){return h},get positionY(){return d},get positionZ(){return f},get upX(){return p},get upY(){return m},get upZ(){return v}}})(Vn,zn,Jn,po,Jt),_o=((e,t,n,o,r,a)=>class extends n{constructor(n,a){super(n),this._nativeContext=n,ve.set(this,n);const i=n.sampleRate;Object.defineProperty(n,"sampleRate",{get:()=>i}),o(n)&&r.set(n,new Set),this._destination=new e(this,a),this._listener=t(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){const t="function"==typeof e?a(this,e):null;this._nativeContext.onstatechange=t;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Ln,Co,hn,Jt,new WeakMap,Gt),bo=((e,t,n,o,r,a,i)=>(s,c)=>{const u=n(s,(e=>e.createOscillator()));return Ot(u,c),Et(u,c,"detune"),Et(u,c,"frequency"),void 0!==c.periodicWave?u.setPeriodicWave(c.periodicWave):Nt(u,c,"type"),t(o,(()=>o(s)))||Dt(u),t(r,(()=>r(s)))||i(u,s),t(a,(()=>a(s)))||Pt(u),e(s,u),u})(xn,Zt,tn,An,Sn,Nn,On),To=((e,t,n,o,r)=>()=>{const a=new WeakMap;let i=null,s=null,c=null;return{set periodicWave(e){i=e},set start(e){s=e},set stop(e){c=e},render(u,l,h){const d=a.get(l);return void 0!==d?Promise.resolve(d):(async(u,l,h)=>{let d=n(u);const f=xe(d,l);if(!f){const e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===i?void 0:i,type:d.type};d=t(l,e),null!==s&&d.start(s),null!==c&&d.stop(c)}return a.set(l,d),f?(await e(l,u.detune,d.detune,h),await e(l,u.frequency,d.frequency,h)):(await o(l,u.detune,d.detune,h),await o(l,u.frequency,d.frequency,h)),await r(u,l,d,h),d})(u,l,h)}}})(En,bo,Ze,Pn,rn),Io=((e,t,n,o,r,a,i,s)=>class extends e{constructor(e,n=Lt){const s=a(e),c={...Lt,...n},u=o(s,c),l=i(s),h=l?r():null,d=e.sampleRate/2;super(e,!1,u,h),this._detune=t(this,l,u.detune,153600,-153600),this._frequency=t(this,l,u.frequency,d,-d),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){const t="function"==typeof e?s(this,e):null;this._nativeOscillatorNode.onended=t;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}get type(){return this._nativeOscillatorNode.type}set type(e){if(this._nativeOscillatorNode.type=e,"custom"===e)throw n();null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer)this._oscillatorNodeRenderer.start=e;else{Re(this);const e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),setTimeout((()=>Ve(this)),1e3)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}})(mn,Vn,Tt,bo,To,cn,Jt,Gt),Mo=(e=>(t,n)=>{const o=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=t.createBuffer(1,2,t.sampleRate);return o.buffer=r,o.loop=!0,o.connect(n),o.start(),()=>{o.stop(),o.disconnect(n)}})(Dn),xo=((e,t,n,o,r,a)=>(i,{curve:s,oversample:c,...u})=>{const l=n(i,(e=>e.createWaveShaper())),h=n(i,(e=>e.createWaveShaper()));Ot(l,u),Ot(h,u);const d=o(i,{...u,gain:1}),f=o(i,{...u,gain:-1}),p=o(i,{...u,gain:1}),m=o(i,{...u,gain:-1});let v=null,g=!1,y=null;const w={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){d.channelCount=e,f.channelCount=e,l.channelCount=e,p.channelCount=e,h.channelCount=e,m.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){d.channelCountMode=e,f.channelCountMode=e,l.channelCountMode=e,p.channelCountMode=e,h.channelCountMode=e,m.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){d.channelInterpretation=e,f.channelInterpretation=e,l.channelInterpretation=e,p.channelInterpretation=e,h.channelInterpretation=e,m.channelInterpretation=e},get context(){return l.context},get curve(){return y},set curve(n){if(null!==s&&s.length<2)throw t();if(null===n)l.curve=n,h.curve=n;else{const e=n.length,t=new Float32Array(e+2-e%2),o=new Float32Array(e+2-e%2);t[0]=n[0],o[0]=-n[e-1];const r=Math.ceil((e+1)/2),a=(e+1)/2-1;for(let i=1;i<r;i+=1){const s=i/r*a,c=Math.floor(s),u=Math.ceil(s);t[i]=c===u?n[c]:(1-(s-c))*n[c]+(1-(u-s))*n[u],o[i]=c===u?-n[e-1-c]:-(1-(s-c))*n[e-1-c]-(1-(u-s))*n[e-1-u]}t[r]=e%2==1?n[r-1]:(n[r-2]+n[r-1])/2,l.curve=t,h.curve=o}y=n,g&&(r(y)&&null===v?v=e(i,d):null!==v&&(v(),v=null))},get inputs(){return[d]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(e){l.oversample=e,h.oversample=e},addEventListener:(...e)=>d.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>d.dispatchEvent(e[0]),removeEventListener:(...e)=>d.removeEventListener(e[0],e[1],e[2])};s!==w.curve&&(w.curve=s),c!==w.oversample&&(w.oversample=c);return a(Rt(w,p),(()=>{d.connect(l).connect(p),d.connect(f).connect(h).connect(m).connect(p),g=!0,r(y)&&(v=e(i,d))}),(()=>{d.disconnect(l),l.disconnect(p),d.disconnect(f),f.disconnect(h),h.disconnect(m),m.disconnect(p),g=!1,null!==v&&(v(),v=null)}))})(Mo,Tt,tn,Mn,Xt,qn),Ao=((e,t,n,o,r,a,i)=>(s,c)=>{const u=n(s,(e=>e.createWaveShaper()));try{return u.curve=new Float32Array([1]),o(s,c)}catch{}Ot(u,c);const l=c.curve;if(null!==l&&l.length<2)throw t();Nt(u,c,"curve"),Nt(u,c,"oversample");let h=null,d=!1;i(u,"curve",(e=>()=>e.call(u)),(t=>n=>(t.call(u,n),d&&(r(n)&&null===h?h=e(s,u):r(n)||null===h||(h(),h=null)),n)));return a(u,(()=>{d=!0,r(u.curve)&&(h=e(s,u))}),(()=>{d=!1,null!==h&&(h(),h=null)}))})(Mo,Tt,tn,xo,Xt,qn,zt),So=((e,t,n,o,r,a,i,s,c,u)=>(l,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:f,distanceModel:p,maxDistance:m,orientationX:v,orientationY:g,orientationZ:y,panningModel:w,positionX:C,positionY:_,positionZ:b,refDistance:T,rolloffFactor:I,...M})=>{const x=n(l,(e=>e.createPanner()));if(M.channelCount>2)throw s();if("max"===M.channelCountMode)throw s();Ot(x,M);const A={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},S=o(l,{...A,channelInterpretation:"speakers",numberOfInputs:6}),N=r(l,{...M,gain:1}),O=r(l,{...A,gain:1}),k=r(l,{...A,gain:0}),E=r(l,{...A,gain:0}),D=r(l,{...A,gain:0}),P=r(l,{...A,gain:0}),R=r(l,{...A,gain:0}),V=a(l,256,6,1),F=i(l,{...A,curve:new Float32Array([1,1]),oversample:"none"});let B=[v,g,y],L=[C,_,b];V.onaudioprocess=({inputBuffer:e})=>{const t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0]];t.some(((e,t)=>e!==B[t]))&&(x.setOrientation(...t),B=t);const n=[e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];n.some(((e,t)=>e!==L[t]))&&(x.setPosition(...n),L=n)},Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0});const W={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount(e){if(e>2)throw s();N.channelCount=e,x.channelCount=e},get channelCountMode(){return x.channelCountMode},set channelCountMode(e){if("max"===e)throw s();N.channelCountMode=e,x.channelCountMode=e},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation(e){N.channelInterpretation=e,x.channelInterpretation=e},get coneInnerAngle(){return x.coneInnerAngle},set coneInnerAngle(e){x.coneInnerAngle=e},get coneOuterAngle(){return x.coneOuterAngle},set coneOuterAngle(e){x.coneOuterAngle=e},get coneOuterGain(){return x.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();x.coneOuterGain=e},get context(){return x.context},get distanceModel(){return x.distanceModel},set distanceModel(e){x.distanceModel=e},get inputs(){return[N]},get maxDistance(){return x.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;x.maxDistance=e},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get orientationX(){return O.gain},get orientationY(){return k.gain},get orientationZ(){return E.gain},get panningModel(){return x.panningModel},set panningModel(e){if(x.panningModel=e,x.panningModel!==e&&"HRTF"===e)throw s()},get positionX(){return D.gain},get positionY(){return P.gain},get positionZ(){return R.gain},get refDistance(){return x.refDistance},set refDistance(e){if(e<0)throw new RangeError;x.refDistance=e},get rolloffFactor(){return x.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;x.rolloffFactor=e},addEventListener:(...e)=>N.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>N.dispatchEvent(e[0]),removeEventListener:(...e)=>N.removeEventListener(e[0],e[1],e[2])};h!==W.coneInnerAngle&&(W.coneInnerAngle=h),d!==W.coneOuterAngle&&(W.coneOuterAngle=d),f!==W.coneOuterGain&&(W.coneOuterGain=f),p!==W.distanceModel&&(W.distanceModel=p),m!==W.maxDistance&&(W.maxDistance=m),v!==W.orientationX.value&&(W.orientationX.value=v),g!==W.orientationY.value&&(W.orientationY.value=g),y!==W.orientationZ.value&&(W.orientationZ.value=y),w!==W.panningModel&&(W.panningModel=w),C!==W.positionX.value&&(W.positionX.value=C),_!==W.positionY.value&&(W.positionY.value=_),b!==W.positionZ.value&&(W.positionZ.value=b),T!==W.refDistance&&(W.refDistance=T),I!==W.rolloffFactor&&(W.rolloffFactor=I),1===B[0]&&0===B[1]&&0===B[2]||x.setOrientation(...B),0===L[0]&&0===L[1]&&0===L[2]||x.setPosition(...L);return u(Rt(W,x),(()=>{N.connect(x),e(N,F,0,0),F.connect(O).connect(S,0,0),F.connect(k).connect(S,0,1),F.connect(E).connect(S,0,2),F.connect(D).connect(S,0,3),F.connect(P).connect(S,0,4),F.connect(R).connect(S,0,5),S.connect(V).connect(l.destination)}),(()=>{N.disconnect(x),c(N,F,0,0),F.disconnect(O),O.disconnect(S),F.disconnect(k),k.disconnect(S),F.disconnect(E),E.disconnect(S),F.disconnect(D),D.disconnect(S),F.disconnect(P),P.disconnect(S),F.disconnect(R),R.disconnect(S),S.disconnect(V),V.disconnect(l.destination)}))})(Ye,Tt,tn,zn,Mn,po,Ao,Bt,Xe,qn),No=((e,t)=>(n,o)=>{const r=e(n,(e=>e.createPanner()));return void 0===r.orientationX?t(n,o):(Ot(r,o),Et(r,o,"orientationX"),Et(r,o,"orientationY"),Et(r,o,"orientationZ"),Et(r,o,"positionX"),Et(r,o,"positionY"),Et(r,o,"positionZ"),Nt(r,o,"coneInnerAngle"),Nt(r,o,"coneOuterAngle"),Nt(r,o,"coneOuterGain"),Nt(r,o,"distanceModel"),Nt(r,o,"maxDistance"),Nt(r,o,"panningModel"),Nt(r,o,"refDistance"),Nt(r,o,"rolloffFactor"),r)})(tn,So),Oo=((e,t,n,o,r,a,i,s,c,u)=>()=>{const l=new WeakMap;let h=null;return{render(d,f,p){const m=l.get(f);return void 0!==m?Promise.resolve(m):(async(d,f,p)=>{let m=null,v=a(d);const g={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},y={...g,coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor},w=xe(v,f);if("bufferSize"in v)m=o(f,{...g,gain:1});else if(!w){const e={...y,orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value};v=r(f,e)}if(l.set(f,null===m?v:m),null!==m){if(null===h){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new i(6,d.context.length,f.sampleRate),o=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});o.connect(e.destination),h=(async()=>{const t=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(t,o)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===o?1:0});return await s(e,t,r.offset,p),r})));for(let e=0;e<6;e+=1)t[e].connect(o,0,e),t[e].start(0);return u(e)})()}const e=await h,a=o(f,{...g,gain:1});await c(d,f,a,p);const l=[];for(let t=0;t<e.numberOfChannels;t+=1)l.push(e.getChannelData(t));let v=[l[0][0],l[1][0],l[2][0]],w=[l[3][0],l[4][0],l[5][0]],C=o(f,{...g,gain:1}),_=r(f,{...y,orientationX:v[0],orientationY:v[1],orientationZ:v[2],positionX:w[0],positionY:w[1],positionZ:w[2]});a.connect(C).connect(_.inputs[0]),_.connect(m);for(let t=128;t<e.length;t+=128){const e=[l[0][t],l[1][t],l[2][t]],n=[l[3][t],l[4][t],l[5][t]];if(e.some(((e,t)=>e!==v[t]))||n.some(((e,t)=>e!==w[t]))){v=e,w=n;const i=t/f.sampleRate;C.gain.setValueAtTime(0,i),C=o(f,{...g,gain:0}),_=r(f,{...y,orientationX:v[0],orientationY:v[1],orientationZ:v[2],positionX:w[0],positionY:w[1],positionZ:w[2]}),C.gain.setValueAtTime(1,i),a.connect(C).connect(_.inputs[0]),_.connect(m)}}return m}return w?(await e(f,d.orientationX,v.orientationX,p),await e(f,d.orientationY,v.orientationY,p),await e(f,d.orientationZ,v.orientationZ,p),await e(f,d.positionX,v.positionX,p),await e(f,d.positionY,v.positionY,p),await e(f,d.positionZ,v.positionZ,p)):(await s(f,d.orientationX,v.orientationX,p),await s(f,d.orientationY,v.orientationY,p),await s(f,d.orientationZ,v.orientationZ,p),await s(f,d.positionX,v.positionX,p),await s(f,d.positionY,v.positionY,p),await s(f,d.positionZ,v.positionZ,p)),je(v)?await c(d,f,v.inputs[0],p):await c(d,f,v,p),v})(d,f,p)}}})(En,zn,Jn,Mn,No,Ze,$t,Pn,rn,vo),ko=((e,t,n,o,r,a)=>class extends e{constructor(e,i=Wt){const s=r(e),c={...Wt,...i},u=n(s,c),l=a(s);super(e,!1,u,l?o():null),this._nativePannerNode=u,this._orientationX=t(this,l,u.orientationX,Ee,ke),this._orientationY=t(this,l,u.orientationY,Ee,ke),this._orientationZ=t(this,l,u.orientationZ,Ee,ke),this._positionX=t(this,l,u.positionX,Ee,ke),this._positionY=t(this,l,u.positionY,Ee,ke),this._positionZ=t(this,l,u.positionZ,Ee,ke)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}})(mn,Vn,No,Oo,cn,Jt),Eo=(e=>(t,{disableNormalization:n,imag:o,real:r})=>{const a=e(t),i=new Float32Array(o),s=new Float32Array(r);return null!==a?a.createPeriodicWave(s,i,{disableNormalization:n}):t.createPeriodicWave(s,i,{disableNormalization:n})})(en),Do=((e,t,n)=>class o{constructor(o,r){const a=t(o),i={...jt,...r},s=e(a,i);return n.add(s),s}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===o.prototype||n.has(e)}})(Eo,cn,new WeakSet),Po=((e,t,n,o,r,a)=>{const i=16385,s=new Float32Array([1,1]),c=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},h=(e,a,h,d,f)=>{if(1===a)return((e,t,r,a)=>{const h=new Float32Array(i),d=new Float32Array(i);for(let e=0;e<i;e+=1){const t=e/16384*c;h[e]=Math.cos(t),d[e]=Math.sin(t)}const f=n(e,{...u,gain:0}),p=o(e,{...l,curve:h}),m=o(e,{...l,curve:s}),v=n(e,{...u,gain:0}),g=o(e,{...l,curve:d});return{connectGraph(){t.connect(f),t.connect(m.inputs[0]),t.connect(v),m.connect(r),r.connect(p.inputs[0]),r.connect(g.inputs[0]),p.connect(f.gain),g.connect(v.gain),f.connect(a,0,0),v.connect(a,0,1)},disconnectGraph(){t.disconnect(f),t.disconnect(m.inputs[0]),t.disconnect(v),m.disconnect(r),r.disconnect(p.inputs[0]),r.disconnect(g.inputs[0]),p.disconnect(f.gain),g.disconnect(v.gain),f.disconnect(a,0,0),v.disconnect(a,0,1)}}})(e,h,d,f);if(2===a)return((e,r,a,h)=>{const d=new Float32Array(i),f=new Float32Array(i),p=new Float32Array(i),m=new Float32Array(i),v=Math.floor(8192.5);for(let e=0;e<i;e+=1)if(e>v){const t=(e-v)/(16384-v)*c;d[e]=Math.cos(t),f[e]=Math.sin(t),p[e]=0,m[e]=1}else{const t=e/(16384-v)*c;d[e]=1,f[e]=0,p[e]=Math.cos(t),m[e]=Math.sin(t)}const g=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=n(e,{...u,gain:0}),w=o(e,{...l,curve:d}),C=n(e,{...u,gain:0}),_=o(e,{...l,curve:f}),b=o(e,{...l,curve:s}),T=n(e,{...u,gain:0}),I=o(e,{...l,curve:p}),M=n(e,{...u,gain:0}),x=o(e,{...l,curve:m});return{connectGraph(){r.connect(g),r.connect(b.inputs[0]),g.connect(y,1),g.connect(C,1),g.connect(T,1),g.connect(M,1),b.connect(a),a.connect(w.inputs[0]),a.connect(_.inputs[0]),a.connect(I.inputs[0]),a.connect(x.inputs[0]),w.connect(y.gain),_.connect(C.gain),I.connect(T.gain),x.connect(M.gain),y.connect(h,0,0),T.connect(h,0,0),C.connect(h,0,1),M.connect(h,0,1)},disconnectGraph(){r.disconnect(g),r.disconnect(b.inputs[0]),g.disconnect(y,1),g.disconnect(C,1),g.disconnect(T,1),g.disconnect(M,1),b.disconnect(a),a.disconnect(w.inputs[0]),a.disconnect(_.inputs[0]),a.disconnect(I.inputs[0]),a.disconnect(x.inputs[0]),w.disconnect(y.gain),_.disconnect(C.gain),I.disconnect(T.gain),x.disconnect(M.gain),y.disconnect(h,0,0),T.disconnect(h,0,0),C.disconnect(h,0,1),M.disconnect(h,0,1)}}})(e,h,d,f);throw r()};return(t,{channelCount:o,channelCountMode:i,pan:s,...c})=>{if("max"===i)throw r();const u=e(t,{...c,channelCount:1,channelCountMode:i,numberOfInputs:2}),l=n(t,{...c,channelCount:o,channelCountMode:i,gain:1}),d=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:s});let{connectGraph:f,disconnectGraph:p}=h(t,o,l,d,u);Object.defineProperty(d.gain,"defaultValue",{get:()=>0});const m={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){l.channelCount!==e&&(v&&p(),({connectGraph:f,disconnectGraph:p}=h(t,e,l,d,u)),v&&f()),l.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw r();l.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){l.channelInterpretation=e},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return d.gain},addEventListener:(...e)=>l.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>l.dispatchEvent(e[0]),removeEventListener:(...e)=>l.removeEventListener(e[0],e[1],e[2])};let v=!1;return a(Rt(m,u),(()=>{f(),v=!0}),(()=>{p(),v=!1}))}})(zn,Un,Mn,Ao,Bt,qn),Ro=((e,t,n)=>(o,r)=>e(o,(e=>{const a=r.channelCountMode;if("clamped-max"===a)throw n();if(void 0===o.createStereoPanner)return t(o,r);const i=e.createStereoPanner();return Ot(i,r),Et(i,r,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>a,set:e=>{if(e!==a)throw n()}}),i})))(tn,Po,Bt),Vo=((e,t,n,o,r)=>()=>{const a=new WeakMap;return{render(i,s,c){const u=a.get(s);return void 0!==u?Promise.resolve(u):(async(i,s,c)=>{let u=n(i);const l=xe(u,s);if(!l){const e={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=t(s,e)}return a.set(s,u),l?await e(s,i.pan,u.pan,c):await o(s,i.pan,u.pan,c),je(u)?await r(i,s,u.inputs[0],c):await r(i,s,u,c),u})(i,s,c)}}})(En,Ro,Ze,Pn,rn),Fo=((e,t,n,o,r,a)=>class extends e{constructor(e,i=Yt){const s=r(e),c={...Yt,...i},u=n(s,c),l=a(s);super(e,!1,u,l?o():null),this._pan=t(this,l,u.pan,1,-1)}get pan(){return this._pan}})(mn,Vn,Ro,Vo,cn,Jt),Bo=((e,t,n)=>()=>{const o=new WeakMap;return{render(r,a,i){const s=o.get(a);return void 0!==s?Promise.resolve(s):(async(r,a,i)=>{let s=t(r);if(!xe(s,a)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,curve:s.curve,oversample:s.oversample};s=e(a,t)}return o.set(a,s),je(s)?await n(r,a,s.inputs[0],i):await n(r,a,s,i),s})(r,a,i)}}})(Ao,Ze,rn),Lo=((e,t,n,o,r,a)=>class extends e{constructor(e,t=qt){const i=r(e),s={...qt,...t},c=n(i,s);super(e,!0,c,a(i)?o():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}})(mn,Tt,Ao,Bo,cn,Jt),Wo=(e=>null!==e&&e.isSecureContext)(Ht),jo=(e=>(t,n,o)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get:()=>Math.round(t*n)},currentTime:{configurable:!0,get:()=>t}});try{return o()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}})(Ht),Yo=Wo?((e,t,n,o,r,a,i,s,c)=>(u,l,h={credentials:"omit"})=>{const d=a(u),f=new URL(l,c.location.href).toString();if(void 0!==d.audioWorklet)return o(l).then((e=>{const[t,n]=be(e,f),o=new Blob([`${t};(registerProcessor=>{${n}\n})((n,p)=>registerProcessor(n,class extends p{process(i,o,p){return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),a=URL.createObjectURL(o),i=r(d);return(null!==i?i:d).audioWorklet.addModule(a,h).then((()=>URL.revokeObjectURL(a))).catch((e=>{throw URL.revokeObjectURL(a),void 0!==e.code&&"SyntaxError"!==e.name||(e.code=12),e}))}));const p=s.get(u);if(void 0!==p&&p.has(l))return Promise.resolve();const m=i.get(u);if(void 0!==m){const e=m.get(l);if(void 0!==e)return e}const v=o(l).then((e=>{const[n,o]=be(e,f);return t(`${n};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${o}\n})})(window,'_AWGS')`)})).then((()=>{const t=c._AWGS.pop();if(void 0===t)throw new SyntaxError;n(d.currentTime,d.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const o=we.get(d);if(void 0!==o){if(o.has(t))throw e();Ie(n),Te(n.parameterDescriptors),o.set(t,n)}else Ie(n),Te(n.parameterDescriptors),we.set(d,new Map([[t,n]]))}),d.sampleRate,void 0,void 0)))})).catch((e=>{throw void 0!==e.code&&"SyntaxError"!==e.name||(e.code=12),e}));return void 0===m?i.set(u,new Map([[l,v]])):m.set(l,v),v.then((()=>{const e=s.get(u);void 0===e?s.set(u,new Set([l])):e.add(l)})).catch((()=>{})).then((()=>{const e=i.get(u);void 0!==e&&e.delete(l)})),v})(Bt,(e=>t=>new Promise(((n,o)=>{if(null===e)return void o(new SyntaxError);const r=e.document.head;if(null===r)o(new SyntaxError);else{const a=e.document.createElement("script"),i=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(i),c=e.onerror,u=()=>{e.onerror=c,URL.revokeObjectURL(s)};e.onerror=(t,n,r,a,i)=>n===s||n===e.location.href&&1===r&&1===a?(u(),o(i),!1):null!==c?c(t,n,r,a,i):void 0,a.onerror=()=>{u(),o(new SyntaxError)},a.onload=()=>{u(),n()},a.src=s,a.type="module",r.appendChild(a)}})))(Ht),jo,(e=>async t=>{try{const e=await fetch(t);if(e.ok)return e.text()}catch{}throw e()})((()=>{try{return new DOMException("","AbortError")}catch(e){return e.code=20,e.name="AbortError",e}})),en,cn,new WeakMap,new WeakMap,Ht):void 0,qo=((e,t)=>n=>e(n)||t(n))(dn,Jt),Xo=((e,t,n,o,r,a,i,s,c,u,l,h,d)=>(f,p)=>{const m=i(f)?f:a(f);if(r.has(p)){const e=n();return Promise.reject(e)}try{r.add(p)}catch{}if(t(l,(()=>l(m)))){return("closed"===m.state&&null!==c&&s(m)?new c(1,1,m.sampleRate):m).decodeAudioData(p).catch((e=>{if(e instanceof DOMException&&"NotSupportedError"===e.name)throw new TypeError;throw e})).then((n=>(t(u,(()=>u(n)))||d(n),e.add(n),n)))}return new Promise(((t,n)=>{const r=()=>{try{(e=>{const{port1:t}=new MessageChannel;t.postMessage(e,[e])})(p)}catch{}},a=e=>{n(e),r()};try{m.decodeAudioData(p,(n=>{"function"!=typeof n.copyFromChannel&&(h(n),Ne(n)),e.add(n),r(),t(n)}),(e=>{a(null===e?o():e)}))}catch(e){a(e)}}))})(yn,Zt,(()=>{try{return new DOMException("","DataCloneError")}catch(e){return e.code=25,e.name="DataCloneError",e}}),(()=>{try{return new DOMException("","EncodingError")}catch(e){return e.code=0,e.name="EncodingError",e}}),new WeakSet,cn,qo,Jt,$t,Ae,St,bn,Tn),zo=((e,t,n,o,r,a,i,s,c,u,l,h,d,f,p,m,v,g,y,w)=>class extends p{constructor(t,n){super(t,n),this._nativeContext=t,this._audioWorklet=void 0===e?void 0:{addModule:(t,n)=>e(this,t,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new r(this)}createBuffer(e,t,o){return new n({length:t,numberOfChannels:e,sampleRate:o})}createBufferSource(){return new o(this)}createChannelMerger(e=6){return new a(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new i(this,{numberOfOutputs:e})}createConstantSource(){return new s(this)}createConvolver(){return new c(this)}createDelay(e=1){return new l(this,{maxDelayTime:e})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(e,t){return new f(this,{feedback:t,feedforward:e})}createOscillator(){return new m(this)}createPanner(){return new v(this)}createPeriodicWave(e,t,n={disableNormalization:!1}){return new g(this,{...n,imag:t,real:e})}createStereoPanner(){return new y(this)}createWaveShaper(){return new w(this)}decodeAudioData(e,t,n){return u(this._nativeContext,e).then((e=>("function"==typeof t&&t(e),e))).catch((e=>{throw"function"==typeof n&&n(e),e}))}})(Yo,gn,In,Bn,Yn,Zn,Hn,eo,ro,Xo,so,lo,fo,wo,_o,Io,ko,Do,Fo,Lo),Go=(e=>(t,n)=>e(t,(e=>e.createMediaElementSource(n.mediaElement))))(tn),Zo=((e,t,n,o)=>class extends e{constructor(e,r){const a=n(e),i=t(a,r);if(o(a))throw TypeError();super(e,!0,i,null),this._mediaElement=r.mediaElement,this._nativeMediaElementAudioSourceNode=i}get mediaElement(){return void 0===this._nativeMediaElementAudioSourceNode.mediaElement?this._mediaElement:this._nativeMediaElementAudioSourceNode.mediaElement}})(mn,Go,cn,Jt),Uo=((e,t)=>(n,o)=>{if(void 0===n.createMediaStreamDestination)throw t();const r=e(n,(e=>e.createMediaStreamDestination()));return Ot(r,o),1===r.numberOfOutputs&&Object.defineProperty(r,"numberOfOutputs",{get:()=>0}),r})(tn,Bt),Qo=((e,t,n,o)=>class extends e{constructor(e,r=At){const a=n(e);if(o(a))throw new TypeError;const i={...At,...r},s=t(a,i);super(e,!1,s,null),this._nativeMediaStreamAudioDestinationNode=s}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(mn,Uo,cn,Jt),Ho=(e=>(t,{mediaStream:n})=>{const o=n.getAudioTracks(),r=e(t,(e=>{o.sort(((e,t)=>e.id<t.id?-1:e.id>t.id?1:0));const t=o.slice(0,1);return e.createMediaStreamSource(new MediaStream(t))}));return Object.defineProperty(r,"mediaStream",{value:n}),r})(tn),$o=((e,t,n,o)=>class extends e{constructor(e,r){const a=n(e),i=t(a,r);if(o(a))throw new TypeError;super(e,!0,i,null),this._nativeMediaStreamAudioSourceNode=i}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(mn,Ho,cn,Jt),Jo=((e,t,n)=>(o,{mediaStreamTrack:r})=>"function"==typeof o.createMediaStreamTrackSource?t(o,(e=>e.createMediaStreamTrackSource(r))):t(o,(t=>{const o=new MediaStream([r]),a=t.createMediaStreamSource(o);if("audio"!==r.kind)throw e();if(n(t))throw new TypeError;return a})))(Tt,tn,Jt),Ko=((e,t,n)=>class extends e{constructor(e,o){const r=n(e);super(e,!0,t(r,o),null)}})(mn,Jo,cn),er=((e,t,n,o,r,a,i,s,c)=>class extends e{constructor(e={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const t=new c(e);if(null===t)throw o();if(!(e=>void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e))(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw n();super(t,2);const{latencyHint:r}=e,{sampleRate:a}=t;if(this._baseLatency="number"==typeof t.baseLatency?t.baseLatency:"balanced"===r?512/a:"interactive"===r||void 0===r?256/a:"playback"===r?1024/a:128*Math.max(2,Math.min(128,Math.round(r*a/128)))/a,this._nativeAudioContext=t,this._state=null,"running"===t.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",e)};t.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close())}createMediaElementSource(e){return new r(this,{mediaElement:e})}createMediaStreamDestination(){return new a(this)}createMediaStreamSource(e){return new i(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new s(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise(((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((e=>{if(void 0===e||15===e.code)throw t();throw e}))}suspend(){return this._nativeAudioContext.suspend().catch((e=>{if(void 0===e)throw t();throw e}))}})(zo,Tt,Bt,(()=>{try{return new DOMException("","UnknownError")}catch(e){return e.name="UnknownError",e}}),Zo,Qo,$o,Ko,Kt);var tr,nr;(e=>{null===e||e.hasOwnProperty("AudioWorkletNode")&&e.AudioWorkletNode})(Ht),function(e){e.INIT="INIT",e.PLAYING="PLAYING",e.STOPPED="STOPPED",e.PAUSED="PAUSED"}(tr||(tr={})),function(e){e.STATE_CHANGE="state-change",e.ITERATION="iteration"}(nr||(nr={}));return class{constructor(e=new er,t=new L){this.defaultBpm=100,this.scoreInstruments=[],this.ready=!1,this.ac=e,this.ac.suspend(),this.instrumentPlayer=t,this.instrumentPlayer.init(this.ac),this.availableInstruments=this.instrumentPlayer.instruments,this.events=new q,this.cursor=null,this.sheet=null,this.scheduler=null,this.lastIterationNotes=null,this.iterationSteps=0,this.currentIterationStep=0,this.timeoutHandles=[],this.playbackSettings={bpm:this.defaultBpm,masterVolume:1},this.setState(tr.INIT)}get wholeNoteLength(){return Math.round(60/this.playbackSettings.bpm*4e3)}getPlaybackInstrument(e){if(!this.sheet)return null;const t=this.sheet.Instruments.flatMap((e=>e.Voices)).find((t=>t.VoiceId===e));return this.availableInstruments.find((e=>e.midiId===t.midiInstrumentId))}setInstrument(t,n){return e(this,void 0,void 0,(function*(){yield this.instrumentPlayer.load(n),t.midiInstrumentId=n}))}loadScore(t){return e(this,void 0,void 0,(function*(){this.ready=!1,this.sheet=t.Sheet,this.scoreInstruments=this.sheet.Instruments,this.cursor=t.cursor,this.sheet.HasBPMInfo&&this.setBpm(this.sheet.DefaultStartTempoInBpm),yield this.loadInstruments(),this.initInstruments(),this.scheduler=new n(this.wholeNoteLength,this.ac,((e,t,n)=>this.notePlaybackCallback(e,t,n))),this.countAndSetIterationSteps(),this.ready=!0,this.setState(tr.STOPPED)}))}initInstruments(){for(const e of this.sheet.Instruments)for(const t of e.Voices)t.midiInstrumentId=e.MidiInstrumentId}loadInstruments(){return e(this,void 0,void 0,(function*(){let e=[];for(const t of this.sheet.Instruments){null==this.availableInstruments.find((e=>e.midiId===t.MidiInstrumentId))&&this.fallbackToPiano(t),e.push(this.instrumentPlayer.load(t.MidiInstrumentId))}yield Promise.all(e)}))}fallbackToPiano(e){console.warn(`Can't find playback instrument for midiInstrumentId ${e.MidiInstrumentId}. Falling back to piano`),e.MidiInstrumentId=0,null==this.availableInstruments.find((e=>0===e.midiId))&&console.error("Piano fallback failed, grand piano not supported")}play(){return e(this,void 0,void 0,(function*(){yield this.ac.resume(),this.state!==tr.INIT&&this.state!==tr.STOPPED||this.cursor.show(),this.setState(tr.PLAYING),this.scheduler.start()}))}stop(){return e(this,void 0,void 0,(function*(){this.setState(tr.STOPPED),this.stopPlayers(),this.clearTimeouts(),this.scheduler.reset(),this.cursor.reset(),this.currentIterationStep=0,this.cursor.hide()}))}pause(){this.setState(tr.PAUSED),this.ac.suspend(),this.stopPlayers(),this.scheduler.setIterationStep(this.currentIterationStep),this.scheduler.pause(),this.clearTimeouts()}jumpToStep(e){for(this.pause(),this.currentIterationStep>e&&(this.cursor.reset(),this.currentIterationStep=0);this.currentIterationStep<e;)this.cursor.next(),++this.currentIterationStep;let t=this.currentIterationStep;this.currentIterationStep>0&&this.currentIterationStep<this.iterationSteps&&++t,this.scheduler.setIterationStep(t)}setBpm(e){this.playbackSettings.bpm=e,this.scheduler&&(this.scheduler.wholeNoteLength=this.wholeNoteLength)}on(e,t){this.events.on(e,t)}countAndSetIterationSteps(){this.cursor.reset();let e=0;for(;!this.cursor.Iterator.EndReached;)this.cursor.Iterator.CurrentVoiceEntries&&this.scheduler.loadNotes(this.cursor.Iterator.CurrentVoiceEntries),this.cursor.next(),++e;this.iterationSteps=e,this.cursor.reset()}notePlaybackCallback(e,t,n){if(this.state!==tr.PLAYING)return;let o=new Map;for(let e of t){if(e.isRest())continue;const t=j(e,this.wholeNoteLength);if(0===t)continue;e.noteDuration=t;const n=Y(e),r=W(e),a=e.ParentVoiceEntry.ParentVoice.midiInstrumentId,i=e.ParentVoiceEntry.ParentVoice.Parent.SubInstruments[0].fixedKey||0;o.has(a)||o.set(a,[]),o.get(a).push({note:e.halfTone-12*i,duration:t/1e3,gain:n,articulation:r})}for(const[t,n]of o)this.instrumentPlayer.schedule(t,this.ac.currentTime+e,n);let r={};r.notes=t,r.type="NOTE_ON",this.timeoutHandles.push(window.setTimeout((()=>this.iterationCallback()),Math.max(0,1e3*e-35)),window.setTimeout((()=>{null!=this.lastIterationNotes&&(this.events.emit(nr.ITERATION,this.lastIterationNotes),this.lastIterationNotes=null),this.events.emit(nr.ITERATION,r);let o={};o.notes=t,o.type="NOTE_OFF",this.lastIterationNotes=o,n&&window.setTimeout((()=>{null!=this.lastIterationNotes&&(this.events.emit(nr.ITERATION,this.lastIterationNotes),this.lastIterationNotes=null),console.log("<><><><><><><><><><><><><><><><><>")}),1e3*e)}),1e3*e))}setState(e){this.state=e,this.events.emit(nr.STATE_CHANGE,e)}stopPlayers(){for(const e of this.sheet.Instruments)for(const t of e.Voices)this.instrumentPlayer.stop(t.midiInstrumentId)}clearTimeouts(){for(let e of this.timeoutHandles)clearTimeout(e);this.timeoutHandles=[]}iterationCallback(){this.state===tr.PLAYING&&(this.currentIterationStep>0&&this.cursor.next(),++this.currentIterationStep)}}}));
